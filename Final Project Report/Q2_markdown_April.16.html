<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>STATS5620_Q2_Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Q2_markdown_April.16_files/libs/clipboard/clipboard.min.js"></script>
<script src="Q2_markdown_April.16_files/libs/quarto-html/quarto.js"></script>
<script src="Q2_markdown_April.16_files/libs/quarto-html/popper.min.js"></script>
<script src="Q2_markdown_April.16_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Q2_markdown_April.16_files/libs/quarto-html/anchor.min.js"></script>
<link href="Q2_markdown_April.16_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Q2_markdown_April.16_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Q2_markdown_April.16_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Q2_markdown_April.16_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Q2_markdown_April.16_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">STATS5620_Q2_Analysis</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="stat-5620-project-outline" class="level1">
<h1>STAT 5620 Project Outline</h1>
<p><strong>Linking Diet and Reproductive Success in Northwest Atlantic Grey Seals</strong></p>
<p>Max Henry-Adams (B00952295) and Peter Braithwaite (B00504978)</p>
<p>Data Analysis STAT 4620/5620 Winter 24-25”</p>
<p>Link to GitHub Repository: <a href="https://github.com/MaxHA17/STAT5620.Project" class="uri">https://github.com/MaxHA17/STAT5620.Project</a></p>
<p><strong>Abstract:</strong></p>
<p><strong>Keywords:</strong> Capital breeding strategy, Generalized Linear Models, Pinnipeds, Quantitative Fatty Acid Signature Analysis, Reproductive Ecology</p>
</section>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>For marine predators, prey distribution may vary unpredictably in time and space, undergoing seasonal, inter annual, and longer-term changes in environmental conditions. Understanding how top predators use different foraging strategies to navigate and adapt to patchy and unpredictable prey availability has important implications for individual fitness and population dynamics, yet studies exploring the consequences of such decisions on fitness are relatively rare (Nathan et al., 2008).</p>
<p>Vertebrates fuel the costs of reproduction along a continuum of an income-capital breeding strategy, where animals that use an income breeding strategy rely on concurrent energy accumulation during the breeding period as opposed to a capital breeding strategy, where energy acquired and stored prior to the breeding period is used solely to finance major reproductive costs (Stephens et al., 2009; Stephens et al., 2014). A capital breeding strategy is thought to be advantageous for large animals capable of carrying large energy stores and offers energetic benefits in areas of patchy or unreliable food availability and allows parents to direct more resources (e.g.&nbsp;time and energy) towards offspring, as opposed to foraging, during the breeding and lactation period (Stephens et al., 2009; Stephens et al., 2014). Given the importance of pre-breeding and lactation period foraging success and energy acquisition in capital breeders, these species offer interesting model systems to study the relationships between diet and reproductive success.</p>
<p>Phocid seals are wide-ranging, large-bodied, and long-lived marine predators, with individuals of many species foraging across a wide range of habitats over large temporal scales (Bowen and Jonsen, 2022). Grey seals (<em>Halichoerus grypus</em>) are a long-lived, sexually dimorphic, phocid species and are capital breeders. In the Sable Island population, pregnant females haul out in late December or early January, give birth to a single pup and nurse that pup for 16-18 days, relying solely on energy accumulated during the foraging period prior to parturition to support the costs of lactation (Iverson et al., 1993; Stephens et al., 2009). At or near the abrupt weaning of that pup, females are mated and return to sea to replenish spent body reserves and, after a several month period of delayed implantation, to support gestation and most importantly preparation for the subsequent December or early January lactation period. As in all mammals, the costs of lactation, and its contribution to reproductive success, far exceed the costs of gestation. Like most other phocids, grey seals are generalist predators (Bowen and Jonsen, 2022), but females tend to feed on a narrower range of energy rich species (predominantly sand lance, redfish, and other pelagic fishes) following the lactation period and expand their prey diversity in the several months leading up to the December-January breeding and lactation period (Beck et al., 2007). Female grey seals reach sexual maturity at age 4-5 years and can continue to reproduce as late as into their early 40s (Bowen et al., 2006). During the brief 16–18-day lactation period, females utilize approximately 25-38% of parturition body mass and daily maternal mass loss is a significant predictor of pup growth rates during lactation, with heavier mothers at parturition weaning heavier pups (Iverson et al., 1993; Mellish et al., 1999). While pup survival is positively related to pup weaning mass up to the mean population weaning mass of 51.5 kg, body length at weaning is the best predictor of grey seal pup survival, as predicted by a bigger-is-better hypothesis for size selective mortality (Bowen et al., 2015). The phenomena of heavier females weaning larger offspring is evident even from primiparity where it is believed that heavier females have larger resource stores that they can mobilize during lactation to produce larger offspring at weaning (Iverson et al., 1993; Mellish et al., 1999; Bowen et al., 2006). Following the lactation period, parental care abruptly ends and the pup is left to fast and survive for several weeks on the energy acquired during lactation before undertaking its first foraging trip (Noren et al., 2008). Thus, answering questions relating to the diet of females prior to parturition will improve our understanding of the importance of habitat use and energy acquisition as they relate to life history characteristics, such as reproductive success, in these capital breeders.</p>
<p>Northwest Atlantic grey seals breeding on Sable Island, Nova Scotia, tend to be central place foragers and have high fidelity to Sable Island for breeding and as a haul-out site, making them excellent candidates for long-term studies (Bowen et al., 2015). Using diet estimations methods, such as quantitative fatty acid (FA) signature analysis (QFASA; Iverson et al., 2004, Beck et al., 2007), it becomes possible to explore the relationship between diet variation and reproductive success at the individual level. QFASA is used to estimate predator diet by comparing the FA signatures of predator adipose tissue to those of candidate prey species (Iverson, 2009; Karnovsky et al., 2012). Predator FA signatures alone have historically been used to provide a qualitative assessment of spatial and temporal patterns in diet diversity. However, since many FAs that are biosynthesized within unique prey species accumulate in predator adipose tissue over time, evaluating the amount of prey-specific FAs relative to the predator’s overall FA stores can provide a quantitative estimate of diet, known as QFASA (Iverson et al., 2004). For accurate diet estimation, species-specific calibration coefficients must be experimentally derived to account for the altered incorporation of prey FAs into the predator adipose tissue due to lipid metabolic processes within the predator (Iverson et al., 2004; Karnovsky et al., 2012). When calibration coefficients are derived and the FA signature of many or all potential prey species in an ecosystem is known, as in the case of the Northwest Atlantic grey seal range (Iverson et al., 2004; Beck et al., 2007), QFASA can provide a statistical approach to accurately depicting diet and prey diversity over ecologically relevant time scales (e.g., weeks to several months).</p>
<p>This study will test the hypothesis that differences in diet will affect an individual’s ability to store energy prior to parturition, and thus influence their reproductive success. Specifically, we will explore two research questions:</p>
<ol type="1">
<li><p>Does variation in diet influence maternal mass change over the foraging period leading up to parturition in Northwest Atlantic grey seals?</p></li>
<li><p>Does female diet predict pup weaning mass in Northwest Atlantic grey seals?</p></li>
</ol>
<section id="data-description" class="level2">
<h2 class="anchored" data-anchor-id="data-description">Data description</h2>
<p><em>Response variables (organized by research question):</em></p>
<ol type="1">
<li><p>Maternal mass change during the pre-breeding season foraging period: continuous variable ranging from -45 – 88 kg. Calculated by subtracting the maternal recovery mass from her deployment mass.</p></li>
<li><p>Pup weaning mass: continuous variable ranging from 34.5 – 63 kg. Denotes the mass of the pup after the mother has terminated the lactation period and departed the pup and/or Sable Island.</p></li>
</ol>
</section>
<section id="predictor-or-supporting-variables" class="level2">
<h2 class="anchored" data-anchor-id="predictor-or-supporting-variables">Predictor or supporting variables</h2>
<ol start="3" type="1">
<li><p>Year: discrete variable with values ranging from 1996-2015. Denotes the year in which each observation was collected.</p></li>
<li><p>Maternal ID: discrete variable with a unique identifier for each individual female.</p></li>
<li><p>Pup sex: categorical; male or female.</p></li>
<li><p>Maternal age: discrete variable with values ranging from 7-40 years old.</p></li>
<li><p>Maternal deployment mass: continuous variable with values ranging from 116 – 250 kg. Describes the female mass when she was located pregnant on Sable Island 3-6 months prior to parturition and prior to undergoing her pre-parturition foraging period.</p></li>
<li><p>Maternal mass at parturition: continuous variable ranging from ~ 137 – 250 kg. This is the mass of the female after returning to Sable Island and giving birth to her pup.</p></li>
<li><p>Maternal dominant prey species: discrete variable with 6 unique values. Represents the species making up the greatest proportion of the female diet.</p></li>
<li><p>Maternal dietary energy density: continuous variable ranging from 4.88 – 6.51 kJ/g. Energy density (kJ/g) of the female diet is calculated from the average energy content per gram of prey body tissue.</p></li>
<li><p>Maternal diet diversity: continuous variable 0.18 – 0.58, no specific units. Diversity is calculated using a standardized Shannon-Weaver diversity index to quantify individual diet diversity.</p></li>
</ol>
</section>
</section>
<section id="method" class="level1">
<h1>Method</h1>
<p>The initial step was data cleaning to ensure all readily apparent data errors were rectified prior to data analysis and model fitting. Most of the data errors discovered resulted from the absence of critical data and thus these observations were removed from the dataset. The first question dataset resulted an initial dataset of 56 observations (n=56) and the second question resulted in 76 observations (n=76). It should also be noted that additional observations were filtered from the dataset throughout the analysis process as = outliers with high leverage were also removed. Thus, the final dataset used for question one had 72 observation and the final dataset for question two had 50 observations.</p>
<p>Once cleaned and uploaded to RStudio, initial data plots were made using the ‘flexplot’ and ‘plot_explore,’ the R function we have included in our Git Hub. These visualizations facilitated the exploration of variable distributions, specifically the response variables. From this it was determined that the response variables for both questions, Maternal Mass Change and Pup Weaning Mass, were Gaussian distributed. This normality allowed the exploration of the data through General Linear Models as well as more complex Generalized Linear Models and Mixed Models. Although our original analytical approach proposal Generalized Linear Mixed Models, it felt prudent to explore the efficiency, interpret ability and computational simplify of Linear Models if the assumption were met and the data suggested linearity.</p>
<p>As a result, both questions were analysed first as Linear Models (LM), then as Generalized Linear Models (GLM) with Gaussian distributions, and finally as Generalized Linear Mixed Models (GLMM) with Random Effects and Fixed Effects on some and all the categorical data. With each model type we began with all the predictor variables prior to using the backward and forward “Step” function to reduce the number of variables through elimination based on the p-values for Linear Models and AIC for GLM and GLMM.</p>
<p>Once we had established the best fit model for both questions using the AIC these models were tested using Cross Validation, question one with 7 folds and question two with 11 folds.</p>
</section>
<section id="analysis" class="level1">
<h1>Analysis</h1>
<section id="research-question-1" class="level2">
<h2 class="anchored" data-anchor-id="research-question-1">Research Question 1</h2>
<p>Here we are exploring whether variation in diet influence maternal mass change over the foraging period leading up to parturition in Northwest Atlantic grey seals?</p>
<p>The response variable of interest is maternal mass change. We will first look at the distribution of this variable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Load the data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>Data_Q1<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"/Users/peterbraithwaite/Desktop/IDPhD Classes/Stat 5620_Updated/Final Project/Proposal Presentation/Working Folder/R/Processed_Data/Data_Q1.csv"</span>, <span class="at">header =</span> T)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Ensure the data types are correctly assigned</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>Data_Q1<span class="sc">$</span>MomID <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Data_Q1<span class="sc">$</span>MomID)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>Data_Q1<span class="sc">$</span>Year <span class="ot">&lt;-</span> <span class="fu">factor</span>(Data_Q1<span class="sc">$</span>Year, <span class="at">levels =</span> <span class="fu">sort</span>(<span class="fu">unique</span>(Data_Q1<span class="sc">$</span>Year)), <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>Data_Q1<span class="sc">$</span><span class="st">`</span><span class="at">Dominant.prey.species</span><span class="st">`</span><span class="ot">&lt;-</span> <span class="fu">as.character</span>(Data_Q1<span class="sc">$</span><span class="st">`</span><span class="at">Dominant.prey.species</span><span class="st">`</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>Data_Q1<span class="sc">$</span><span class="st">`</span><span class="at">Diet.diversity</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Data_Q1<span class="sc">$</span><span class="st">`</span><span class="at">Diet.diversity</span><span class="st">`</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>Data_Q1<span class="sc">$</span><span class="st">`</span><span class="at">Dietary.energy.density</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Data_Q1<span class="sc">$</span><span class="st">`</span><span class="at">Dietary.energy.density</span><span class="st">`</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Data_Q1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     MomID         Year    Dietary.energy.density Diet.diversity  
 4269   : 3   2013   :13   Min.   :4.881          Min.   :0.1788  
 24     : 2   2011   :11   1st Qu.:5.623          1st Qu.:0.3063  
 146    : 2   2010   : 9   Median :5.753          Median :0.3572  
 829    : 2   2012   : 9   Mean   :5.736          Mean   :0.3625  
 3271   : 2   2009   : 6   3rd Qu.:5.893          3rd Qu.:0.4181  
 3616   : 2   2015   : 5   Max.   :6.517          Max.   :0.5782  
 (Other):63   (Other):23                                          
 Dominant.prey.species  Mass.change    
 Length:76             Min.   :-40.50  
 Class :character      1st Qu.:  6.25  
 Mode  :character      Median : 22.75  
                       Mean   : 26.02  
                       3rd Qu.: 45.00  
                       Max.   : 88.00  
                                       </code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#rename columns</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>Data_Q1 <span class="ot">&lt;-</span> Data_Q1 <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">DietEngDen =</span> <span class="st">`</span><span class="at">Dietary.energy.density</span><span class="st">`</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">DietDiv =</span> <span class="st">`</span><span class="at">Diet.diversity</span><span class="st">`</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">DomSpp =</span> <span class="st">`</span><span class="at">Dominant.prey.species</span><span class="st">`</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">MassChange =</span> <span class="st">`</span><span class="at">Mass.change</span><span class="st">`</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Data_Q1<span class="sc">$</span>MassChange)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There are a total of n=76 observations and mass change appears to follow a normal distribution a Gaussian family distribution is a good starting point for an initial model.</p>
<p>One of the covariates, dominant prey species, is a categorical variable. We will first check the number of observations in each category:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(Data_Q1<span class="sc">$</span>DomSpp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
      AtlanticCod           Capelin NorthernSandlance           Pollock 
                6                 3                29                 5 
          Redfish         WhiteHake 
               32                 1 </code></pre>
</div>
</div>
<p>With only one observation of white hake and 3 observations of capelin, there is likely not enough data to estimate the effect of these species on the response variable and we are unable to draw meaningful conclusions. These points also cause extreme residual values. Capelin and white hake observations will be removed from the data set:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>Data_Q1 <span class="ot">&lt;-</span> Data_Q1 <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(DomSpp <span class="sc">!=</span> <span class="st">"WhiteHake"</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>Data_Q1 <span class="ot">&lt;-</span> Data_Q1 <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(DomSpp <span class="sc">!=</span> <span class="st">"Capelin"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The initial model seeks to model maternal mass change as a function of dominant prey species, diet diversity, dietary energy density, and deployment year. We will now explore the apparent relationships between each continuous and categorical covariate using the plot_explore function built and contained in the STAT5620.Project R package:</p>
<p>Initially, it appears that diet diversity is negatively related to mass change, with energy density possibly having a slight negative relationship. It also appears that animals with cod, redfish or sand lance as the dominant prey species gain more mass during foraging than females who primarily prey on Pollock. There does not appear to be any clear trends in mass change over time.</p>
<p>We will begin with an initial model with all covariates of interest. Based on the distribution of mass change, we will begin with a simple model with a gaussian distribution and an identity link function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mom_mod <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data=</span>Data_Q1, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link=</span><span class="st">"identity"</span>), <span class="at">formula =</span> MassChange <span class="sc">~</span> DietDiv <span class="sc">+</span> DietEngDen <span class="sc">+</span> Year <span class="sc">+</span> DomSpp)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mom_mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: not plotting observations with leverage one:
  45</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The residual plots from this initial model show good homoscedasticity and normality. There is one observation (observation 6) that appears to be an extreme value. This observation comes from a female that experiences an 88 kg increase in mass over the pre-breeding period foraging period, which is well above the mean mass change value of 28.5. However, none of the covariate values associated with this observation are abnormal and this point does not have high leverage. As a results, the decision is to retain this data point since it is not highly influential and knowledge of the system suggests it is a valid data point.</p>
<p>We can now use step selection to preform repeated hypothesis tests for variable selection to determine which covariates best explain maternal mass change while minimizing model complexity and colinearity between covariates.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(mom_mod, <span class="at">direction =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=647.55
MassChange ~ DietDiv + DietEngDen + Year + DomSpp

             Df Deviance    AIC
- DietEngDen  1    19508 645.67
&lt;none&gt;             19478 647.55
- DietDiv     1    20858 650.48
- DomSpp      3    23417 654.82
- Year       13    38977 671.50

Step:  AIC=645.67
MassChange ~ DietDiv + Year + DomSpp

             Df Deviance    AIC
&lt;none&gt;             19508 645.67
+ DietEngDen  1    19478 647.55
- DietDiv     1    20891 648.60
- DomSpp      3    23602 653.38
- Year       13    39769 670.95</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glm(formula = MassChange ~ DietDiv + Year + DomSpp, family = gaussian(link = "identity"), 
    data = Data_Q1)

Coefficients:
            (Intercept)                  DietDiv                   Year.L  
                 70.599                  -63.415                   28.367  
                 Year.Q                   Year.C                   Year^4  
                 12.387                   18.307                   15.184  
                 Year^5                   Year^6                   Year^7  
                -15.549                    3.305                   23.361  
                 Year^8                   Year^9                  Year^10  
                  2.392                  -23.277                  -11.186  
                Year^11                  Year^12                  Year^13  
                 13.261                   21.328                  -39.502  
DomSppNorthernSandlance            DomSppPollock            DomSppRedfish  
                -18.212                  -47.479                  -20.303  

Degrees of Freedom: 71 Total (i.e. Null);  54 Residual
Null Deviance:      48570 
Residual Deviance: 19510    AIC: 645.7</code></pre>
</div>
</div>
<p>The lowest AIC model drops the dietary energy density covariate. We will update the initial model to drop the energy density covariate:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>mom_mod2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> MassChange <span class="sc">~</span> DietDiv <span class="sc">+</span> Year <span class="sc">+</span> DomSpp, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link =</span> <span class="st">"identity"</span>),</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> Data_Q1)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mom_mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: not plotting observations with leverage one:
  45</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-6-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>All model residuals still look good. We can proceed to interpreting model output:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mom_mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = MassChange ~ DietDiv + Year + DomSpp, family = gaussian(link = "identity"), 
    data = Data_Q1)

Coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)               70.599     16.241   4.347 6.15e-05 ***
DietDiv                  -63.415     32.417  -1.956 0.055621 .  
Year.L                    28.367     15.657   1.812 0.075584 .  
Year.Q                    12.387     12.620   0.982 0.330717    
Year.C                    18.307     13.274   1.379 0.173517    
Year^4                    15.184     14.787   1.027 0.309065    
Year^5                   -15.549     12.334  -1.261 0.212857    
Year^6                     3.305     10.924   0.303 0.763373    
Year^7                    23.361     10.525   2.219 0.030674 *  
Year^8                     2.392     10.067   0.238 0.813123    
Year^9                   -23.277     10.057  -2.314 0.024475 *  
Year^10                  -11.186     10.451  -1.070 0.289261    
Year^11                   13.261      9.842   1.347 0.183483    
Year^12                   21.328      8.874   2.403 0.019708 *  
Year^13                  -39.502      9.864  -4.005 0.000191 ***
DomSppNorthernSandlance  -18.212     14.318  -1.272 0.208824    
DomSppPollock            -47.479     16.434  -2.889 0.005550 ** 
DomSppRedfish            -20.303     13.938  -1.457 0.150992    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 361.2663)

    Null deviance: 48567  on 71  degrees of freedom
Residual deviance: 19508  on 54  degrees of freedom
AIC: 645.67

Number of Fisher Scoring iterations: 2</code></pre>
</div>
</div>
<p>While several years have mass change values that significantly differ from the expected mass change value, the effect of time is not of direct interest to our research question and is only present to account for changes in prey dynamics over time. As a result, the interpretation of this output is not relvant. However, we see that females who feed primarily on pollock experience lower mass change than the reference level, in this case being females who primarily feed on cod. Being an identity link function, the model is essentially a simple linear model and there is no transformations applied to the response variable. As such, coefficient estimates can be interpreted directly. In this case, individuals who feed on pollock experience 47.5% lower mass change than individuals who primarily feed on cod. This effect is presented in figure 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Data_Q1, <span class="fu">aes</span>(<span class="at">x =</span> DomSpp, <span class="at">y =</span> MassChange, <span class="at">fill =</span> DomSpp)) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">ymax =</span> ..y.., <span class="at">ymin =</span> ..y..),  </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">1.2</span>  </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="at">x =</span> <span class="st">"Pollock"</span>, <span class="at">y =</span> <span class="dv">20</span>, <span class="at">label =</span> <span class="st">"*"</span>,  </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label),  </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">fontface =</span> <span class="st">"bold"</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Figure 1. Median (black line) and mean (red line) mass change by dominant prey species"</span>,</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Prey species"</span>,</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Mass change (kg)"</span>, <span class="at">fill =</span> <span class="st">"Dominant prey species"</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span>),  <span class="co"># Add axis lines</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(Data_Q1<span class="sc">$</span>MassChange), <span class="at">by =</span> <span class="dv">25</span>) <span class="sc">-</span> <span class="dv">50</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `size` argument of `element_line()` is deprecated as of ggplot2 3.4.0.
ℹ Please use the `linewidth` argument instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The dot-dot notation (`..y..`) was deprecated in ggplot2 3.4.0.
ℹ Please use `after_stat(y)` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It may also be worth noting that diet diversity is almost significant at p = 0.0556. While this p-value is not significant, the negative relationship between diet diversity and mass change may support the observed effects of dominant prey species, where individuals who primarily prey on cod, sand lance, or redfish and have a lower diet diversity due to this focus on a few profitable species are more successful in gaining mass than individuals who feed on a more diverse array of prey species which include less profitable species.</p>
<p>We can perform cross-validation to to test this models predictions. In order to have each fold represent about 10% of the data, we will perform 7 fold cross validation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Number of folds</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into folds</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>DatCV <span class="ot">&lt;-</span> Data_Q1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">fold =</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>k, <span class="at">length.out =</span> <span class="fu">n</span>())))</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a vector to store RMSE for each fold</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>rmse_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Perform cross validation</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> DatCV <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fold <span class="sc">!=</span> i)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  test_data  <span class="ot">&lt;-</span> DatCV <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fold <span class="sc">==</span> i)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the model on training data</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>modCV <span class="ot">&lt;-</span> <span class="fu">glm</span>(MassChange <span class="sc">~</span> DietDiv <span class="sc">+</span> Year <span class="sc">+</span> DomSpp, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link =</span> <span class="st">"identity"</span>), <span class="at">data =</span> Data_Q1)</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Predict on the test data</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>  predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(modCV, <span class="at">newdata =</span> test_data)</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute RMSE for this fold</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>  actuals <span class="ot">&lt;-</span> test_data<span class="sc">$</span>MassChange</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>  rmse_values[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((predictions <span class="sc">-</span> actuals)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>rmse_values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 22.44760 11.88442 18.05650 11.05129 18.98355 15.02906 14.37965</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>mean_rmse <span class="ot">&lt;-</span> <span class="fu">mean</span>(rmse_values)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Average RMSE across"</span>, k, <span class="st">"folds:"</span>, <span class="fu">round</span>(mean_rmse, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Average RMSE across 7 folds: 15.98 </code></pre>
</div>
</div>
<p>The average root mean squared error is 15.98, indicating the model generally predicts values within 16 kg of the true value. Check the standard deviation to compare the average RMSE to:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(Data_Q1<span class="sc">$</span>MassChange)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 26.15433</code></pre>
</div>
</div>
<p>Compared to the standard deviation of mass change, the RMSE value is about 40% lower than the standard deviation, meaning the model predictions are much better than using the population mean to predict mass change. However, compared to the overall mean mass change within our dataset (28.5 kg), there is relatively large prediction error. We can also visualize prediction accuracy with a fitted vs observed value plot (figure 2):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>fit_mom <span class="ot">&lt;-</span> <span class="fu">fitted</span>(mom_mod2)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the observed response variable (actual values)</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>obs_mom <span class="ot">&lt;-</span> Data_Q1<span class="sc">$</span>MassChange</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the fitted vs. observed values</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Data_Q1, <span class="fu">aes</span>(<span class="at">x =</span> fit_mom, <span class="at">y =</span> obs_mom)) <span class="sc">+</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span>  <span class="co"># Add 1:1 line</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Figure 2. Fitted vs. Observed Values with 1:1 line"</span>,</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Fitted Values"</span>,</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Observed Values"</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>While figure 2 shows that the model predictions have consistent accuracy across the range of fitted values, as suggested by the average RMSE value obtained from cross-validation, there is reasonably large prediction error. Given that the model residuals suggest good model fit, the relatively large prediction error suggest the set of covariates used in this model are not sufficient in predicting maternal mass change. From this we can conclude that females who feed on redfish, sand lance, or cod experience greater mass change than individuals who feed on Pollock, but other factors outside of maternal diet, such as individual physiology or characteristics associated with individual foraging behavior, are responsible for explaining a large proportion of variation in maternal mass change.</p>
</section>
<section id="research-question-2" class="level2">
<h2 class="anchored" data-anchor-id="research-question-2">Research Question 2</h2>
</section>
<section id="does-variation-in-diet-of-maternal-female-predict-pup-weaning-mass-in-northwest-atlantic-grey-seals" class="level2">
<h2 class="anchored" data-anchor-id="does-variation-in-diet-of-maternal-female-predict-pup-weaning-mass-in-northwest-atlantic-grey-seals">Does variation in diet of maternal female predict pup weaning mass in Northwest Atlantic grey seals?</h2>
</section>
<section id="load-data" class="level2">
<h2 class="anchored" data-anchor-id="load-data">Load Data</h2>
<p>require(tinytex) quarto install tinytex</p>
<p>Cleaned data file was uploaded. seal_data = read.csv(“Data_Q2.csv”, header = T)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>seal_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"/Users/peterbraithwaite/Desktop/IDPhD Classes/Stat 5620_Updated/Final Project/Proposal Presentation/Working Folder/R/Processed_Data/Data_Q2.csv"</span>, <span class="at">header =</span> T)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(seal_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     MomID            Year      Dietary.energy.density Diet.diversity  
 Min.   :   19   Min.   :1996   Min.   :5.207          Min.   :0.1788  
 1st Qu.:  467   1st Qu.:2002   1st Qu.:5.676          1st Qu.:0.3108  
 Median : 4688   Median :2011   Median :5.784          Median :0.3564  
 Mean   : 4999   Mean   :2008   Mean   :5.772          Mean   :0.3622  
 3rd Qu.: 9412   3rd Qu.:2013   3rd Qu.:5.900          3rd Qu.:0.4181  
 Max.   :10690   Max.   :2015   Max.   :6.517          Max.   :0.5290  
 Dominant.prey.species    Mom.Age         Pup.sex      Pup.Wean.Mass  
 Length:56             Min.   : 9.00   Min.   :1.000   Min.   :34.50  
 Class :character      1st Qu.:23.00   1st Qu.:1.000   1st Qu.:45.50  
 Mode  :character      Median :25.00   Median :1.000   Median :50.75  
                       Mean   :23.46   Mean   :1.464   Mean   :50.31  
                       3rd Qu.:26.25   3rd Qu.:2.000   3rd Qu.:55.12  
                       Max.   :31.00   Max.   :2.000   Max.   :63.00  </code></pre>
</div>
</div>
</section>
<section id="data-exploration" class="level2">
<h2 class="anchored" data-anchor-id="data-exploration">Data Exploration</h2>
<p>The package “flexplot” was used to explore the predictor and response variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(flexplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: flexplot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'flexplot'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    flip_data</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">flexplot</span> (MomID<span class="sc">~</span><span class="dv">1</span>, <span class="at">data=</span> seal_data)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="fu">flexplot</span> (Year<span class="sc">~</span><span class="dv">1</span>, <span class="at">data=</span> seal_data)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span> <span class="fu">flexplot</span> (Dietary.energy.density<span class="sc">~</span><span class="dv">1</span>, <span class="at">data=</span> seal_data)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">flexplot</span> (Diet.diversity<span class="sc">~</span><span class="dv">1</span>, <span class="at">data=</span> seal_data)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>e <span class="ot">=</span> <span class="fu">flexplot</span> (Dominant.prey.species<span class="sc">~</span><span class="dv">1</span>, <span class="at">data=</span> seal_data)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>f <span class="ot">=</span> <span class="fu">flexplot</span> (Mom.Age<span class="sc">~</span><span class="dv">1</span>, <span class="at">data=</span> seal_data)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>g <span class="ot">=</span> <span class="fu">flexplot</span> (Pup.sex<span class="sc">~</span><span class="dv">1</span>, <span class="at">data=</span> seal_data)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>h <span class="ot">=</span> <span class="fu">flexplot</span> (Pup.Wean.Mass<span class="sc">~</span><span class="dv">1</span>, <span class="at">data=</span> seal_data)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span> (cowplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: cowplot</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(a,b,c,d,e,f,g,h)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-1---exploring-variable-distributions" class="level4">
<h4 class="anchored" data-anchor-id="figure-1---exploring-variable-distributions">Figure 1 - Exploring Variable Distributions</h4>
<p>From the plots above it seems that the response variable (Pup Wean Mass) has a Gaussian distribution.</p>
<p>To further explore the relationship between variable the package “ggplot2” was used plot individual variables in relation to the repsonse variables.</p>
</section>
</section>
<section id="pup-wean-mass-and-dietary-engery-density" class="level2">
<h2 class="anchored" data-anchor-id="pup-wean-mass-and-dietary-engery-density">Pup Wean Mass and Dietary Engery Density</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(ggplot2)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Pup Wean Mass + Dietary.energy.density</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(seal_data) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(Dietary.energy.density, Pup.Wean.Mass, <span class="at">color =</span> Dominant.prey.species)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Pup Wean Mass and Dietary Energy Density"</span>, <span class="at">x =</span> <span class="st">"Dietary Energy Density (kJ/g of prey tissue)"</span>, <span class="at">y =</span> <span class="st">"Pup Wean Mass (Kg)"</span>) <span class="sc">+</span> <span class="fu">geom_smooth</span> (<span class="fu">aes</span>(Dietary.energy.density, Pup.Wean.Mass), <span class="at">method=</span><span class="st">"lm"</span>, <span class="at">se=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-2---pup-wean-mass-and-dietary-energy-density" class="level4">
<h4 class="anchored" data-anchor-id="figure-2---pup-wean-mass-and-dietary-energy-density">Figure 2 - Pup Wean Mass and Dietary Energy Density</h4>
<p>From this plot we can see a negative or inverse relationship between Pup Wean Mass and Dietary Energy Density. This indicates that maternal mothers that feed on prey species resulting in greater dietary energy density tend to have pups with a lower wean mass. This is somewhat at odds with what might have been expected. We might have expected the greater the dietary energy density of the materanl mother would result in heavier and ultimately more fit pups.</p>
<p>We can also see that the Dominant Species Capelin has only three observation and one of these appears to be an outlier. It should also be noted that White Hake has only one observation and Atlantic Cod has only three. This lack of observations may be problematic while fitting a model and we may need to remove these Dominant Prey Species.</p>
</section>
</section>
<section id="pup-wean-mass-and-dietary-engery-density-1" class="level2">
<h2 class="anchored" data-anchor-id="pup-wean-mass-and-dietary-engery-density-1">Pup Wean Mass and Dietary Engery Density</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pup Wean Mass + Diet Diveristy</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(seal_data) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(Diet.diversity, Pup.Wean.Mass, <span class="at">color =</span> Dominant.prey.species)) <span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Pup Wean Mass and Diet Diversity"</span>, <span class="at">x =</span> <span class="st">"Diet Diveristy (no specific units for Shannon index)"</span>, <span class="at">y =</span> <span class="st">"Pup Wean Mass (Kg)"</span>) <span class="sc">+</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(Diet.diversity, Pup.Wean.Mass), <span class="at">method=</span><span class="st">"lm"</span>, <span class="at">se=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-3---pup-wean-mass-and-diet-diversity" class="level4">
<h4 class="anchored" data-anchor-id="figure-3---pup-wean-mass-and-diet-diversity">Figure 3 - Pup Wean Mass and Diet Diversity</h4>
<p>From this plot we can see a negative or inverse relationship between Pup Wean Mass and Diet Diversity. This indicates that as the maternal mothers feed on more diverse prey species their pup wean mass decreases. This may indicates that mothers that reduce the diversity of their diet have healthier and more fit pups.</p>
</section>
</section>
<section id="pup-wean-mass-year" class="level2">
<h2 class="anchored" data-anchor-id="pup-wean-mass-year">Pup Wean Mass + Year</h2>
<p>Exploring if specific years showed abnormally high or low Pup Wean Mass and if these were related to specific dominant prey species.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(seal_data) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(Year, Pup.Wean.Mass, <span class="at">color =</span> Dominant.prey.species)) <span class="sc">+</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Pup Wean Mass and Year"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Pup Wean Mass (Kg)"</span>) <span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span> (<span class="fu">aes</span>(Year, Pup.Wean.Mass), <span class="at">method=</span><span class="st">"lm"</span>, <span class="at">se=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-4---pup-wean-mass-and-year" class="level4">
<h4 class="anchored" data-anchor-id="figure-4---pup-wean-mass-and-year">Figure 4 - Pup Wean Mass and Year</h4>
<p>From this plot it seems Pup Wean Mass seems to be fairly evenly distributed over the observed years and it does not seem that a specific Dominant Prey Species had a disproportionate effect on the Pup Wean Mass.</p>
</section>
</section>
<section id="pup-wean-mass-momid" class="level2">
<h2 class="anchored" data-anchor-id="pup-wean-mass-momid">Pup Wean Mass + MomID</h2>
<p>Exploring if Pup Wean Mass shows significant differences based on the maternal mother ID.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(seal_data) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(MomID, Pup.Wean.Mass, <span class="at">color =</span> Year )) <span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Pup Wean Mass and Mom ID"</span>, <span class="at">x =</span> <span class="st">"Mom ID"</span>, <span class="at">y =</span> <span class="st">"Pup Wean Mass (Kg)"</span>) <span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_smooth</span>(<span class="fu">aes</span>(MomID, Pup.Wean.Mass), <span class="at">method=</span><span class="st">"lm"</span>, <span class="at">se=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-5---pup-wean-mass-and-materianl-mother-id" class="level4">
<h4 class="anchored" data-anchor-id="figure-5---pup-wean-mass-and-materianl-mother-id">Figure 5 - Pup Wean Mass and Materianl Mother ID</h4>
<p>With the vertical rows of the this plot representing unique maternal mothers, it does not seem any individual is creating disproportionately large or small pup weights. Rather, it seems most maternal mother are creating a fairly evenly distribution of pup weights dependent on the year.</p>
</section>
</section>
<section id="pup-wean-mass-dominant-prey-species" class="level2">
<h2 class="anchored" data-anchor-id="pup-wean-mass-dominant-prey-species">Pup Wean Mass + Dominant Prey Species</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(seal_data) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(Dominant.prey.species, Pup.Wean.Mass, <span class="at">color =</span> Year )) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Pup Wean Mass and Dominant Prey Species"</span>, <span class="at">x =</span> <span class="st">"Dominant Prey Species"</span>, <span class="at">y =</span> <span class="st">"Pup Wean Mass (Kg)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-6---pup-wean-mass-and-dominant-prey-species" class="level4">
<h4 class="anchored" data-anchor-id="figure-6---pup-wean-mass-and-dominant-prey-species">Figure 6 - Pup Wean Mass and Dominant Prey Species</h4>
<p>A considerable amount of insight can be gained from this plot including: The Dominant Prey Species with the largest number of observations (Northern Sandiance and Redfish) show a variety of Pup Wean Masses and these occur over a wide variety of years; the Dominant Prey Species with the smallest number of observations tend to show either predominantly large (Atlantic Cod and Capelin) or very small (Pollock and White Hake) Pup Wean sizes and these tend to occur in a variety of years.</p>
</section>
</section>
<section id="pup-wean-mass-pup-sex" class="level2">
<h2 class="anchored" data-anchor-id="pup-wean-mass-pup-sex">Pup Wean Mass + Pup Sex</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(seal_data) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(Pup.sex, Pup.Wean.Mass, <span class="at">color =</span> Year )) <span class="sc">+</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Pup Wean Mass and Pup Sex"</span>, <span class="at">x =</span> <span class="st">"Pup Sex"</span>, <span class="at">y =</span> <span class="st">"Pup Wean Mass (Kg)"</span>) <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(Pup.sex, Pup.Wean.Mass), <span class="at">method=</span><span class="st">"lm"</span>, <span class="at">se=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-7---pup-wean-mass-and-pup-sex" class="level4">
<h4 class="anchored" data-anchor-id="figure-7---pup-wean-mass-and-pup-sex">Figure 7 - Pup Wean Mass and Pup Sex</h4>
<p>This plot shows that the Pup Sex seems to have little effect on the average Pup Mean Mass. Both Pup Sex seem to create a fairly even distribution of Pup Mean Mass over a variety of years. It is expected that this variable will have a small effect on the fit model.</p>
</section>
</section>
<section id="pup-wean-mass-maternal-age" class="level2">
<h2 class="anchored" data-anchor-id="pup-wean-mass-maternal-age">Pup Wean Mass + Maternal Age</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(seal_data) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(Mom.Age, Pup.Wean.Mass, <span class="at">colour =</span> Dominant.prey.species)) <span class="sc">+</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Pup Wean Mass and Maternal Age"</span>, <span class="at">x =</span> <span class="st">"Maternal Age"</span>, <span class="at">y =</span> <span class="st">"Pup Wean Mass (Kg)"</span>) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(Mom.Age, Pup.Wean.Mass), <span class="at">method=</span><span class="st">"lm"</span>, <span class="at">se=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-7---pup-wean-mass-and-maternal-age" class="level4">
<h4 class="anchored" data-anchor-id="figure-7---pup-wean-mass-and-maternal-age">Figure 7 - Pup Wean Mass and Maternal Age</h4>
<p>A considerable amount of insight can be gained from this plot. It seems younger maternal seals have larger pups but it is also noteworthy that the majority of older mothers prey on the most observed Dominant Prey Species including Redfish and Northern Sandlance. Alternatively it seems less frequent observed Dominant Prey Species were preyed on by young maternal mothers. It seems as though there might be a social aspects to why younger mothers prey on less frequently observed Dominant Prey Species.</p>
</section>
</section>
</section>
<section id="fit-linear-model" class="level1">
<h1>Fit Linear Model</h1>
<p>We now explore fitting general linear models to further explore the variables, the residuals and their relationships.</p>
<p>First we convert the catagorical data to factors and determine the number of levels within each catagorical group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert catagorical data to factors </span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>seal_data<span class="sc">$</span>MomID <span class="ot">=</span> <span class="fu">as.factor</span>(seal_data<span class="sc">$</span>MomID)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>seal_data<span class="sc">$</span>Year <span class="ot">=</span> <span class="fu">as.factor</span>(seal_data<span class="sc">$</span>Year)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>seal_data<span class="sc">$</span>Dominant.prey.species <span class="ot">=</span> <span class="fu">as.factor</span>(seal_data<span class="sc">$</span>Dominant.prey.species)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>seal_data<span class="sc">$</span>Pup.sex <span class="ot">=</span> <span class="fu">as.factor</span>(seal_data<span class="sc">$</span>Pup.sex)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>seal_data<span class="sc">$</span>Pup.Mom.Age <span class="ot">=</span> <span class="fu">as.factor</span>(seal_data<span class="sc">$</span>Mom.Age)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="fu">nlevels</span>(seal_data<span class="sc">$</span>MomID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 51</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 51</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nlevels</span>(seal_data<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 13</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nlevels</span>(seal_data<span class="sc">$</span>Dominant.prey.species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nlevels</span>(seal_data<span class="sc">$</span>Pup.sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nlevels</span>(seal_data<span class="sc">$</span>Pup.Mom.Age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 17</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="fit-linear-model-1" class="level2">
<h2 class="anchored" data-anchor-id="fit-linear-model-1">Fit Linear Model</h2>
<section id="all-predictor-variables" class="level3">
<h3 class="anchored" data-anchor-id="all-predictor-variables">All Predictor Variables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>Q1 <span class="ot">=</span> <span class="fu">lm</span>(Pup.Wean.Mass <span class="sc">~</span> Dominant.prey.species <span class="sc">+</span> Diet.diversity <span class="sc">+</span> Dietary.energy.density</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Year <span class="sc">+</span> Mom.Age <span class="sc">+</span> Pup.sex <span class="sc">+</span> MomID, <span class="at">data =</span> seal_data)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Q1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Pup.Wean.Mass ~ Dominant.prey.species + Diet.diversity + 
    Dietary.energy.density + Year + Mom.Age + Pup.sex + MomID, 
    data = seal_data)

Residuals:
ALL 56 residuals are 0: no residual degrees of freedom!

Coefficients: (16 not defined because of singularities)
                                        Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                            -127.5808        NaN     NaN      NaN
Dominant.prey.speciesCapelin             14.0800        NaN     NaN      NaN
Dominant.prey.speciesNorthernSandlance    2.5039        NaN     NaN      NaN
Dominant.prey.speciesPollock            -19.7677        NaN     NaN      NaN
Dominant.prey.speciesRedfish            -16.6515        NaN     NaN      NaN
Dominant.prey.speciesWhiteHake            4.6941        NaN     NaN      NaN
Diet.diversity                            8.3424        NaN     NaN      NaN
Dietary.energy.density                   35.8485        NaN     NaN      NaN
Year1997                                 19.2395        NaN     NaN      NaN
Year1998                                 -1.3181        NaN     NaN      NaN
Year2000                                 14.1916        NaN     NaN      NaN
Year2001                                 -0.8124        NaN     NaN      NaN
Year2002                                 -3.0383        NaN     NaN      NaN
Year2009                                 29.8803        NaN     NaN      NaN
Year2010                                 -2.9017        NaN     NaN      NaN
Year2011                                 37.2376        NaN     NaN      NaN
Year2012                                 23.6996        NaN     NaN      NaN
Year2013                                 20.8844        NaN     NaN      NaN
Year2014                                -55.5366        NaN     NaN      NaN
Year2015                                 16.4409        NaN     NaN      NaN
Mom.Age                                  -1.8940        NaN     NaN      NaN
Pup.sex2                                 14.4153        NaN     NaN      NaN
MomID23                                   4.4626        NaN     NaN      NaN
MomID24                                  27.5950        NaN     NaN      NaN
MomID30                                  -7.9254        NaN     NaN      NaN
MomID45                                  88.7703        NaN     NaN      NaN
MomID69                                  26.2285        NaN     NaN      NaN
MomID93                                  -2.2734        NaN     NaN      NaN
MomID109                                 -4.5789        NaN     NaN      NaN
MomID125                                      NA         NA      NA       NA
MomID137                                  3.6242        NaN     NaN      NaN
MomID142                                 -4.6121        NaN     NaN      NaN
MomID146                                  1.8643        NaN     NaN      NaN
MomID574                                      NA         NA      NA       NA
MomID829                                 -3.1820        NaN     NaN      NaN
MomID2668                               -19.0778        NaN     NaN      NaN
MomID2690                                31.0252        NaN     NaN      NaN
MomID2718                                16.5836        NaN     NaN      NaN
MomID2734                               -15.3957        NaN     NaN      NaN
MomID2999                               -31.0853        NaN     NaN      NaN
MomID3271                               -22.2778        NaN     NaN      NaN
MomID3736                                 0.2347        NaN     NaN      NaN
MomID4266                               -12.6464        NaN     NaN      NaN
MomID4269                                -5.2029        NaN     NaN      NaN
MomID5108                                     NA         NA      NA       NA
MomID5485                                     NA         NA      NA       NA
MomID5681                                -9.8719        NaN     NaN      NaN
MomID5846                               -31.6400        NaN     NaN      NaN
MomID6116                                 3.4943        NaN     NaN      NaN
MomID6118                                -9.0816        NaN     NaN      NaN
MomID6122                                     NA         NA      NA       NA
MomID6177                                 8.7215        NaN     NaN      NaN
MomID6630                                10.9350        NaN     NaN      NaN
MomID9018                               -34.0206        NaN     NaN      NaN
MomID9019                               -18.3770        NaN     NaN      NaN
MomID9020                               -21.8694        NaN     NaN      NaN
MomID9021                                     NA         NA      NA       NA
MomID9410                                -2.7034        NaN     NaN      NaN
MomID9417                                     NA         NA      NA       NA
MomID9418                                     NA         NA      NA       NA
MomID9420                                17.6372        NaN     NaN      NaN
MomID9928                               -34.8701        NaN     NaN      NaN
MomID9930                               -27.9118        NaN     NaN      NaN
MomID9931                               -12.0164        NaN     NaN      NaN
MomID9932                                     NA         NA      NA       NA
MomID9933                                     NA         NA      NA       NA
MomID9934                                     NA         NA      NA       NA
MomID10333                                    NA         NA      NA       NA
MomID10687                                    NA         NA      NA       NA
MomID10688                                    NA         NA      NA       NA
MomID10689                                    NA         NA      NA       NA
MomID10690                                    NA         NA      NA       NA

Residual standard error: NaN on 0 degrees of freedom
Multiple R-squared:      1, Adjusted R-squared:    NaN 
F-statistic:   NaN on 55 and 0 DF,  p-value: NA</code></pre>
</div>
</div>
<p>When this model is run we received an error suggesting we have more columns than rows. This suggest we have more variables than observations. As a result we must remove some of the categorical variables. The maternal mother ID seems to be adding a lot of categories (n -51) and did not seem very important in Figure 6 above. As a result Mom ID was removed and the model was fit again.</p>
</section>
<section id="all-predictor-variables-except-mom-id" class="level3">
<h3 class="anchored" data-anchor-id="all-predictor-variables-except-mom-id">All Predictor Variables Except Mom ID</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>Q2 <span class="ot">=</span> <span class="fu">lm</span>(Pup.Wean.Mass <span class="sc">~</span> Dominant.prey.species <span class="sc">+</span> Diet.diversity <span class="sc">+</span> Dietary.energy.density <span class="sc">+</span> Year <span class="sc">+</span> Mom.Age <span class="sc">+</span> Pup.sex , <span class="at">data =</span> seal_data)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>summary </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>standardGeneric for "summary" defined from package "base"

function (object, ...) 
standardGeneric("summary")
&lt;environment: 0x1182efe78&gt;
Methods may be defined for arguments: object
Use  showMethods(summary)  for currently available ones.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted R-squared:  0.209</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="co"># p-value: 0.08393</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Although this model was not significant, it did provide a model that works as a starting point for the Step Function.</p>
</section>
<section id="step-function-forward" class="level3">
<h3 class="anchored" data-anchor-id="step-function-forward">Step Function (Forward)</h3>
<p>We now used the Step Function to determine the best fit model using AIC.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>fwd.model <span class="ot">=</span> <span class="fu">step</span> (Q2, <span class="at">direction=</span><span class="st">'forward'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=216.76
Pup.Wean.Mass ~ Dominant.prey.species + Diet.diversity + Dietary.energy.density + 
    Year + Mom.Age + Pup.sex</code></pre>
</div>
</div>
<p>The forward step retained all variables with AIC = 216.76</p>
</section>
<section id="step-function-backward" class="level3">
<h3 class="anchored" data-anchor-id="step-function-backward">Step Function (Backward)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>backward.model <span class="ot">=</span> <span class="fu">step</span>(Q2, <span class="at">direction=</span><span class="st">'backward'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=216.76
Pup.Wean.Mass ~ Dominant.prey.species + Diet.diversity + Dietary.energy.density + 
    Year + Mom.Age + Pup.sex

                         Df Sum of Sq    RSS    AIC
- Year                   12    347.70 1572.2 206.75
- Mom.Age                 1      1.61 1226.1 214.83
- Pup.sex                 1     17.14 1241.6 215.53
&lt;none&gt;                                1224.5 216.76
- Dietary.energy.density  1     47.89 1272.4 216.91
- Diet.diversity          1     69.12 1293.6 217.83
- Dominant.prey.species   5    329.04 1553.5 220.08

Step:  AIC=206.75
Pup.Wean.Mass ~ Dominant.prey.species + Diet.diversity + Dietary.energy.density + 
    Mom.Age + Pup.sex

                         Df Sum of Sq    RSS    AIC
- Mom.Age                 1      1.51 1573.7 204.81
- Pup.sex                 1      3.13 1575.3 204.87
- Dietary.energy.density  1     50.68 1622.9 206.53
&lt;none&gt;                                1572.2 206.75
- Dominant.prey.species   5    364.88 1937.1 208.44
- Diet.diversity          1    162.65 1734.8 210.27

Step:  AIC=204.81
Pup.Wean.Mass ~ Dominant.prey.species + Diet.diversity + Dietary.energy.density + 
    Pup.sex

                         Df Sum of Sq    RSS    AIC
- Pup.sex                 1      2.57 1576.3 202.90
- Dietary.energy.density  1     49.35 1623.0 204.54
&lt;none&gt;                                1573.7 204.81
- Dominant.prey.species   5    415.52 1989.2 207.93
- Diet.diversity          1    164.37 1738.1 208.37

Step:  AIC=202.9
Pup.Wean.Mass ~ Dominant.prey.species + Diet.diversity + Dietary.energy.density

                         Df Sum of Sq    RSS    AIC
- Dietary.energy.density  1     49.16 1625.4 202.62
&lt;none&gt;                                1576.3 202.90
- Diet.diversity          1    166.48 1742.8 206.52
- Dominant.prey.species   5    456.31 2032.6 207.14

Step:  AIC=202.62
Pup.Wean.Mass ~ Dominant.prey.species + Diet.diversity

                        Df Sum of Sq    RSS    AIC
&lt;none&gt;                               1625.4 202.62
- Diet.diversity         1    124.06 1749.5 204.74
- Dominant.prey.species  5    493.24 2118.7 207.46</code></pre>
</div>
</div>
<p>The backward step retained only the Dominant Prey Species and Diet Diversity variables with AIC 202.62.</p>
</section>
<section id="explore-the-resulting-linear-model-from-backward-step-function" class="level3">
<h3 class="anchored" data-anchor-id="explore-the-resulting-linear-model-from-backward-step-function">Explore The Resulting Linear Model From Backward Step Function</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>Q1_Reduced <span class="ot">=</span> <span class="fu">lm</span>(Pup.Wean.Mass <span class="sc">~</span> Dominant.prey.species <span class="sc">+</span> Diet.diversity,</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> seal_data)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Q1_Reduced)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Pup.Wean.Mass ~ Dominant.prey.species + Diet.diversity, 
    data = seal_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.0508  -4.1950   0.0968   3.2694  13.3653 

Coefficients:
                                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                              64.422      5.013  12.850  &lt; 2e-16 ***
Dominant.prey.speciesCapelin             -5.133      4.743  -1.082 0.284509    
Dominant.prey.speciesNorthernSandlance   -6.630      3.519  -1.884 0.065539 .  
Dominant.prey.speciesPollock            -15.831      4.500  -3.518 0.000949 ***
Dominant.prey.speciesRedfish             -5.797      3.570  -1.624 0.110838    
Dominant.prey.speciesWhiteHake          -14.093      6.838  -2.061 0.044627 *  
Diet.diversity                          -20.491     10.596  -1.934 0.058916 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.76 on 49 degrees of freedom
Multiple R-squared:  0.3509,    Adjusted R-squared:  0.2715 
F-statistic: 4.416 on 6 and 49 DF,  p-value: 0.00121</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted R-squared: 0.2715 </span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="co"># p-value: 0.00121</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This found that the redueced Linear Model is significant with a p-value = 0.00121 and an Adjusted R-Squared = 0.2715 meaning the model accounts for about 27% of the variation of the Pup Wean Mass. It should also be noted that the most significant variables are Pollock with a p-value of 0.000949 and White Hake with a p-value = 0.044627.</p>
<p>We will now look at the residuals for the this model.</p>
</section>
</section>
</section>
<section id="explore-residuals-for-reduced-linear-model" class="level1">
<h1>Explore Residuals for Reduced Linear Model</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(Q1_Reduced)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-8---residual-for-reduced-variables-linear-model" class="level4">
<h4 class="anchored" data-anchor-id="figure-8---residual-for-reduced-variables-linear-model">Figure 8 - Residual for Reduced Variables Linear Model</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co">#residuals </span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">resid</span>(Q1_Reduced)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(Q1_Reduced), res)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="figure-9---residual-for-reduced-variables-linear-model" class="level4">
<h4 class="anchored" data-anchor-id="figure-9---residual-for-reduced-variables-linear-model">Figure 9 - Residual for Reduced Variables Linear Model</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Q1_Reduced, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid, <span class="at">colour =</span> Dominant.prey.species )) <span class="sc">+</span> <span class="fu">geom_point</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="figure-10---residual-for-reduced-variables-linear-model" class="level4">
<h4 class="anchored" data-anchor-id="figure-10---residual-for-reduced-variables-linear-model">Figure 10 - Residual for Reduced Variables Linear Model</h4>
<p>From these residual visualization it seems clear that a number observations seem to be outliers and they should be removed or we should try robust regression strategies. We can see from Figure 10 that it is the observation with White Hake and Pollock as the Dominant Prey Species are clearly outliers.</p>
<p>We will now try to fit a robust regression first.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(robustbase)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: robustbase</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>Q1_Reduced_Robust <span class="ot">=</span> <span class="fu">lmrob</span>(Pup.Wean.Mass <span class="sc">~</span> Dominant.prey.species <span class="sc">+</span> Diet.diversity,</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> seal_data)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Q1_Reduced_Robust)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lmrob(formula = Pup.Wean.Mass ~ Dominant.prey.species + Diet.diversity, data = seal_data)
 \--&gt; method = "MM"
Residuals:
      Min        1Q    Median        3Q       Max 
-15.74108  -3.76149  -0.08415   3.69887  13.97206 

Coefficients:
                                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                              66.326      4.925  13.467  &lt; 2e-16 ***
Dominant.prey.speciesCapelin             -4.698      2.646  -1.776 0.081995 .  
Dominant.prey.speciesNorthernSandlance   -6.460      1.825  -3.540 0.000889 ***
Dominant.prey.speciesPollock            -15.208      3.194  -4.761 1.74e-05 ***
Dominant.prey.speciesRedfish             -6.031      1.719  -3.508 0.000977 ***
Dominant.prey.speciesWhiteHake          -13.271      2.405  -5.518 1.28e-06 ***
Diet.diversity                          -25.898     13.446  -1.926 0.059903 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Robust residual standard error: 5.928 
Multiple R-squared:  0.3699,    Adjusted R-squared:  0.2928 
Convergence in 12 IRWLS iterations

Robustness weights: 
 4 weights are ~= 1. The remaining 52 ones are summarized as
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.4607  0.9074  0.9590  0.9238  0.9847  0.9974 
Algorithmic parameters: 
       tuning.chi                bb        tuning.psi        refine.tol 
        1.548e+00         5.000e-01         4.685e+00         1.000e-07 
          rel.tol         scale.tol         solve.tol          zero.tol 
        1.000e-07         1.000e-10         1.000e-07         1.000e-10 
      eps.outlier             eps.x warn.limit.reject warn.limit.meanrw 
        1.786e-03         1.819e-12         5.000e-01         5.000e-01 
     nResample         max.it       best.r.s       k.fast.s          k.max 
           500             50              2              1            200 
   maxit.scale      trace.lev            mts     compute.rd fast.s.large.n 
           200              0           1000              0           2000 
                  psi           subsampling                   cov 
           "bisquare"         "nonsingular"         ".vcov.avar1" 
compute.outlier.stats 
                 "SM" 
seed : int(0) </code></pre>
</div>
</div>
<p>The robust regression returned a better Adjusted R-Squared = 2928 (appoximately 29% of variation) than the regular regression with that showed approximately 27%. Interestingly all the Dominant Prey Species are now significant coefficients except Capelin. We will now look at the residuals for the robust regression model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">#residuals </span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">resid</span>(Q1_Reduced_Robust)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(Q1_Reduced_Robust), res)</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="figure-11---residual-for-reduced-variables-with-robust-linear-model" class="level4">
<h4 class="anchored" data-anchor-id="figure-11---residual-for-reduced-variables-with-robust-linear-model">Figure 11 - Residual for Reduced Variables with Robust Linear Model</h4>
<p>The residuals look a bit better but not a huge improvement over the linear model above. We will try removing the outlier observation. A new dataset was uploaded below with Pollock and White Hake Dominant Prey Species Removed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>seal_data_2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"/Users/peterbraithwaite/Desktop/IDPhD Classes/Stat 5620_Updated/Final Project/Proposal Presentation/Working Folder/R/Processed_Data/Data_Q2_Reduced.csv"</span>, <span class="at">header =</span> T)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(seal_data_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     MomID              Year      Dietary.energy.density Diet.diversity  
 Min.   :   19.0   Min.   :1996   Min.   :5.207          Min.   :0.1788  
 1st Qu.:  701.5   1st Qu.:2002   1st Qu.:5.686          1st Qu.:0.3061  
 Median : 4269.0   Median :2011   Median :5.805          Median :0.3518  
 Mean   : 4897.8   Mean   :2008   Mean   :5.782          Mean   :0.3531  
 3rd Qu.: 9020.5   3rd Qu.:2013   3rd Qu.:5.904          3rd Qu.:0.3959  
 Max.   :10690.0   Max.   :2015   Max.   :6.517          Max.   :0.5290  
 Dominant.prey.species    Mom.Age         Pup.sex      Pup.Wean.Mass  
 Length:51             Min.   : 9.00   Min.   :1.000   Min.   :37.50  
 Class :character      1st Qu.:23.00   1st Qu.:1.000   1st Qu.:47.00  
 Mode  :character      Median :25.00   Median :1.000   Median :51.50  
                       Mean   :23.22   Mean   :1.431   Mean   :51.36  
                       3rd Qu.:26.00   3rd Qu.:2.000   3rd Qu.:55.50  
                       Max.   :31.00   Max.   :2.000   Max.   :63.00  </code></pre>
</div>
</div>
</section>
<section id="re-fit-linear-model-with-reduced-data-set" class="level3">
<h3 class="anchored" data-anchor-id="re-fit-linear-model-with-reduced-data-set">Re-fit Linear Model with Reduced Data-set</h3>
<p>Removed Pollock and White Hake from Data-set</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>Q3_Full<span class="ot">=</span> <span class="fu">lm</span>(Pup.Wean.Mass <span class="sc">~</span> Dominant.prey.species <span class="sc">+</span> Diet.diversity <span class="sc">+</span> Dietary.energy.density <span class="sc">+</span> Year <span class="sc">+</span> Mom.Age <span class="sc">+</span> Pup.sex , <span class="at">data =</span> seal_data_2)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Q3_Full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Pup.Wean.Mass ~ Dominant.prey.species + Diet.diversity + 
    Dietary.energy.density + Year + Mom.Age + Pup.sex, data = seal_data_2)

Residuals:
     Min       1Q   Median       3Q      Max 
-14.9432  -3.2854   0.9013   3.1288  14.2253 

Coefficients:
                                        Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)                            -258.8154   396.4474  -0.653   0.5174  
Dominant.prey.speciesCapelin             -0.8433     6.9966  -0.121   0.9046  
Dominant.prey.speciesNorthernSandlance   -3.2757     5.2773  -0.621   0.5381  
Dominant.prey.speciesRedfish             -2.9541     5.0552  -0.584   0.5621  
Diet.diversity                          -26.8081    11.8105  -2.270   0.0284 *
Dietary.energy.density                   -7.2831     6.0669  -1.200   0.2367  
Year                                      0.1835     0.2045   0.897   0.3747  
Mom.Age                                  -0.1580     0.2413  -0.655   0.5160  
Pup.sex                                  -0.1694     1.7915  -0.095   0.9251  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.95 on 42 degrees of freedom
Multiple R-squared:  0.1856,    Adjusted R-squared:  0.03048 
F-statistic: 1.197 on 8 and 42 DF,  p-value: 0.3243</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p-value: 0.3243</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted R-squared:  0.03048 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-function-forward-1" class="level3">
<h3 class="anchored" data-anchor-id="step-function-forward-1">Step Function (Forward)</h3>
<p>We now used the Step Function to determine the best fit model using AIC.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>fwd.model <span class="ot">=</span> <span class="fu">step</span> (Q3_Full, <span class="at">direction=</span><span class="st">'forward'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=190
Pup.Wean.Mass ~ Dominant.prey.species + Diet.diversity + Dietary.energy.density + 
    Year + Mom.Age + Pup.sex</code></pre>
</div>
</div>
<p>The forward step retained all variables with AIC = 190. It should be noted that this AIC is better than the best AIC 202.62 for the simple linear regression above.</p>
</section>
<section id="step-function-backward-1" class="level3">
<h3 class="anchored" data-anchor-id="step-function-backward-1">Step Function (Backward)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>backward.model <span class="ot">=</span> <span class="fu">step</span>(Q3_Full, <span class="at">direction=</span><span class="st">'backward'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=190
Pup.Wean.Mass ~ Dominant.prey.species + Diet.diversity + Dietary.energy.density + 
    Year + Mom.Age + Pup.sex

                         Df Sum of Sq    RSS    AIC
- Dominant.prey.species   3    27.752 1514.5 184.94
- Pup.sex                 1     0.316 1487.0 188.01
- Mom.Age                 1    15.188 1501.9 188.52
- Year                    1    28.503 1515.2 188.97
- Dietary.energy.density  1    51.011 1537.7 189.72
&lt;none&gt;                                1486.7 190.00
- Diet.diversity          1   182.378 1669.1 193.90

Step:  AIC=184.94
Pup.Wean.Mass ~ Diet.diversity + Dietary.energy.density + Year + 
    Mom.Age + Pup.sex

                         Df Sum of Sq    RSS    AIC
- Pup.sex                 1     1.573 1516.0 182.99
- Year                    1    36.520 1551.0 184.16
- Mom.Age                 1    52.015 1566.5 184.66
&lt;none&gt;                                1514.5 184.94
- Dietary.energy.density  1   134.905 1649.4 187.29
- Diet.diversity          1   195.457 1709.9 189.13

Step:  AIC=182.99
Pup.Wean.Mass ~ Diet.diversity + Dietary.energy.density + Year + 
    Mom.Age

                         Df Sum of Sq    RSS    AIC
- Year                    1    41.970 1558.0 182.39
- Mom.Age                 1    52.962 1569.0 182.75
&lt;none&gt;                                1516.0 182.99
- Dietary.energy.density  1   134.114 1650.2 185.32
- Diet.diversity          1   195.334 1711.4 187.17

Step:  AIC=182.39
Pup.Wean.Mass ~ Diet.diversity + Dietary.energy.density + Mom.Age

                         Df Sum of Sq    RSS    AIC
- Mom.Age                 1    17.150 1575.2 180.94
&lt;none&gt;                                1558.0 182.39
- Dietary.energy.density  1    93.118 1651.1 183.35
- Diet.diversity          1   187.904 1745.9 186.19

Step:  AIC=180.94
Pup.Wean.Mass ~ Diet.diversity + Dietary.energy.density

                         Df Sum of Sq    RSS    AIC
&lt;none&gt;                                1575.2 180.94
- Dietary.energy.density  1    93.233 1668.4 181.88
- Diet.diversity          1   197.610 1772.8 184.97</code></pre>
</div>
</div>
<p>The backward step retained the Diet Diversity and Dietary.energy.density variables with AIC 180.94. It should be noted that this AIC is better than the best AIC 202.62 for the simple linear regression above.</p>
</section>
<section id="explore-backward-step-linear-model" class="level3">
<h3 class="anchored" data-anchor-id="explore-backward-step-linear-model">Explore Backward Step Linear Model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>Q3_Reduced <span class="ot">=</span> <span class="fu">lm</span>(Pup.Wean.Mass <span class="sc">~</span> Dietary.energy.density <span class="sc">+</span> Diet.diversity,</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> seal_data_2)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Q3_Reduced)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Pup.Wean.Mass ~ Dietary.energy.density + Diet.diversity, 
    data = seal_data_2)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.3764  -4.3276   0.7659   3.9409  13.9590 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              97.382     22.844   4.263 9.39e-05 ***
Dietary.energy.density   -6.374      3.781  -1.686   0.0984 .  
Diet.diversity          -25.954     10.576  -2.454   0.0178 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.728 on 48 degrees of freedom
Multiple R-squared:  0.1372,    Adjusted R-squared:  0.1012 
F-statistic: 3.815 on 2 and 48 DF,  p-value: 0.029</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p-value: 0.029</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted R-squared:  0.1012 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="explore-residuals-for-reduced-dataset-romoving-white-hake-and-pollock" class="level1">
<h1>Explore Residuals For Reduced DataSet Romoving White Hake and Pollock</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(Q3_Reduced)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-12---residual-for-reduced-dataset-white-hake-and-pollock-removed." class="level4">
<h4 class="anchored" data-anchor-id="figure-12---residual-for-reduced-dataset-white-hake-and-pollock-removed.">Figure 12 - Residual for Reduced Dataset (White Hake and Pollock removed).</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Q3_Reduced, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid, <span class="at">color =</span> seal_data_2<span class="sc">$</span>Dominant.prey.species )) <span class="sc">+</span> <span class="fu">geom_point</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="figure-13---residual-for-reduced-dataset-white-hake-and-pollock-removed." class="level4">
<h4 class="anchored" data-anchor-id="figure-13---residual-for-reduced-dataset-white-hake-and-pollock-removed.">Figure 13 - Residual for Reduced Dataset (White Hake and Pollock removed).</h4>
<p>The lowest value of Caplin is now an outlier and has very high leverage. It is most likely best to remove the lowest value of Capelin or remove the Capelin coefficient all together. Below we load a new dataset with the lowest value of Caplelin removed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>seal_data_3 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"/Users/peterbraithwaite/Desktop/IDPhD Classes/Stat 5620_Updated/Final Project/Proposal Presentation/Working Folder/R/Processed_Data/Data_Q2_Reduced_2.csv"</span>, <span class="at">header =</span> T)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(seal_data_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     MomID              Year      Dietary.energy.density Diet.diversity  
 Min.   :   19.0   Min.   :1996   Min.   :5.207          Min.   :0.1788  
 1st Qu.:  701.5   1st Qu.:2002   1st Qu.:5.686          1st Qu.:0.3061  
 Median : 4269.0   Median :2011   Median :5.805          Median :0.3518  
 Mean   : 4897.8   Mean   :2008   Mean   :5.782          Mean   :0.3531  
 3rd Qu.: 9020.5   3rd Qu.:2013   3rd Qu.:5.904          3rd Qu.:0.3959  
 Max.   :10690.0   Max.   :2015   Max.   :6.517          Max.   :0.5290  
 Dominant.prey.species    Mom.Age         Pup.sex      Pup.Wean.Mass  
 Length:51             Min.   : 9.00   Min.   :1.000   Min.   :37.50  
 Class :character      1st Qu.:23.00   1st Qu.:1.000   1st Qu.:47.00  
 Mode  :character      Median :25.00   Median :1.000   Median :51.50  
                       Mean   :23.22   Mean   :1.431   Mean   :51.36  
                       3rd Qu.:26.00   3rd Qu.:2.000   3rd Qu.:55.50  
                       Max.   :31.00   Max.   :2.000   Max.   :63.00  </code></pre>
</div>
</div>
</section>
</section>
<section id="fit-full-model-with-reduced-data-set" class="level1">
<h1>Fit Full Model with Reduced Data Set</h1>
<p>Removed Lowest Value of Capelin species from data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>Q4_Full<span class="ot">=</span> <span class="fu">lm</span>(Pup.Wean.Mass <span class="sc">~</span> Dominant.prey.species <span class="sc">+</span> Diet.diversity <span class="sc">+</span> Dietary.energy.density <span class="sc">+</span> Year <span class="sc">+</span> Mom.Age <span class="sc">+</span> Pup.sex , <span class="at">data =</span> seal_data_3)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Q4_Full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Pup.Wean.Mass ~ Dominant.prey.species + Diet.diversity + 
    Dietary.energy.density + Year + Mom.Age + Pup.sex, data = seal_data_3)

Residuals:
     Min       1Q   Median       3Q      Max 
-14.7728  -3.0865   0.7264   3.0387  12.9970 

Coefficients:
                                        Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                            -311.0480   401.3625  -0.775    0.443
Dominant.prey.speciesCapelin             -1.3014     7.0288  -0.185    0.854
Dominant.prey.speciesNorthernSandlance   -5.1433     5.6712  -0.907    0.370
Dominant.prey.speciesRedfish             -4.6264     5.3875  -0.859    0.395
Diet.diversity                          -20.3147    13.8136  -1.471    0.149
Dietary.energy.density                   -3.6124     7.2924  -0.495    0.623
Year                                      0.1990     0.2056   0.968    0.339
Mom.Age                                  -0.1911     0.2445  -0.782    0.439
Pup.sex                                  -0.1885     1.7953  -0.105    0.917

Residual standard error: 5.962 on 41 degrees of freedom
Multiple R-squared:  0.1651,    Adjusted R-squared:  0.002236 
F-statistic: 1.014 on 8 and 41 DF,  p-value: 0.441</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p-value: 0.002236 </span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted R-squared:0.004332 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="step-function-forward-2" class="level3">
<h3 class="anchored" data-anchor-id="step-function-forward-2">Step Function (Forward)</h3>
<p>We now used the Step Function to determine the best fit model using AIC.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>fwd.model <span class="ot">=</span> <span class="fu">step</span> (Q4_Full, <span class="at">direction=</span><span class="st">'forward'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=186.61
Pup.Wean.Mass ~ Dominant.prey.species + Diet.diversity + Dietary.energy.density + 
    Year + Mom.Age + Pup.sex</code></pre>
</div>
</div>
<p>The forward step retained all variables with AIC = 186.61.</p>
</section>
<section id="step-function-backward-2" class="level3">
<h3 class="anchored" data-anchor-id="step-function-backward-2">Step Function (Backward)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>backward.model <span class="ot">=</span> <span class="fu">step</span>(Q4_Full, <span class="at">direction=</span><span class="st">'backward'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=186.61
Pup.Wean.Mass ~ Dominant.prey.species + Diet.diversity + Dietary.energy.density + 
    Year + Mom.Age + Pup.sex

                         Df Sum of Sq    RSS    AIC
- Dominant.prey.species   3    52.481 1509.7 182.38
- Pup.sex                 1     0.392 1457.6 184.62
- Dietary.energy.density  1     8.721 1465.9 184.91
- Mom.Age                 1    21.729 1478.9 185.35
- Year                    1    33.316 1490.5 185.74
&lt;none&gt;                                1457.2 186.61
- Diet.diversity          1    76.867 1534.1 187.18

Step:  AIC=182.38
Pup.Wean.Mass ~ Diet.diversity + Dietary.energy.density + Year + 
    Mom.Age + Pup.sex

                         Df Sum of Sq    RSS    AIC
- Pup.sex                 1     1.992 1511.7 180.45
- Year                    1    39.426 1549.1 181.67
- Mom.Age                 1    56.342 1566.0 182.21
&lt;none&gt;                                1509.7 182.38
- Dietary.energy.density  1    77.795 1587.5 182.89
- Diet.diversity          1   116.741 1626.4 184.10

Step:  AIC=180.45
Pup.Wean.Mass ~ Diet.diversity + Dietary.energy.density + Year + 
    Mom.Age

                         Df Sum of Sq    RSS    AIC
- Year                    1    45.154 1556.8 179.92
- Mom.Age                 1    56.672 1568.3 180.29
&lt;none&gt;                                1511.7 180.45
- Dietary.energy.density  1    78.067 1589.7 180.97
- Diet.diversity          1   117.958 1629.6 182.20

Step:  AIC=179.92
Pup.Wean.Mass ~ Diet.diversity + Dietary.energy.density + Mom.Age

                         Df Sum of Sq    RSS    AIC
- Mom.Age                 1    18.078 1574.9 178.50
- Dietary.energy.density  1    48.992 1605.8 179.47
&lt;none&gt;                                1556.8 179.92
- Diet.diversity          1   124.319 1681.1 181.76

Step:  AIC=178.5
Pup.Wean.Mass ~ Diet.diversity + Dietary.energy.density

                         Df Sum of Sq    RSS    AIC
&lt;none&gt;                                1574.9 178.50
- Dietary.energy.density  1    66.647 1641.5 178.57
- Diet.diversity          1   159.201 1734.1 181.31</code></pre>
</div>
</div>
<p>The backward step retained the Diet Diversity and Dietary.energy.density variables with AIC=178.5. It should be noted that this the best AIC value so far.</p>
</section>
<section id="explore-best-backward-step-linear-model" class="level3">
<h3 class="anchored" data-anchor-id="explore-best-backward-step-linear-model">Explore Best Backward Step Linear Model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>Q4_Reduced <span class="ot">=</span> <span class="fu">lm</span>(Pup.Wean.Mass <span class="sc">~</span> Dietary.energy.density <span class="sc">+</span> Diet.diversity,</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> seal_data_3)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Q4_Reduced)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Pup.Wean.Mass ~ Dietary.energy.density + Diet.diversity, 
    data = seal_data_3)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.3747  -4.5794   0.8175   4.1879  14.0677 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)              98.933     29.029   3.408  0.00135 **
Dietary.energy.density   -6.614      4.689  -1.410  0.16503   
Diet.diversity          -26.461     12.140  -2.180  0.03432 * 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.789 on 47 degrees of freedom
Multiple R-squared:  0.0977,    Adjusted R-squared:  0.0593 
F-statistic: 2.545 on 2 and 47 DF,  p-value: 0.08928</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extractAIC</span>(Q4_Reduced)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]   3.000 178.496</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p-value: 0.08928</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted R-squared:  0.0593 </span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC=178.496</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="explore-residuals" class="level1">
<h1>Explore Residuals</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(Q4_Reduced)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Q4_Reduced, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid, <span class="at">color =</span> seal_data_3<span class="sc">$</span>Dominant.prey.species )) <span class="sc">+</span> <span class="fu">geom_point</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-16---residual-for-reduced-dataset-white-hake-and-pollock-removed-completely-and-lowest-value-of-capeline." class="level4">
<h4 class="anchored" data-anchor-id="figure-16---residual-for-reduced-dataset-white-hake-and-pollock-removed-completely-and-lowest-value-of-capeline.">Figure 16 - Residual for Reduced Dataset (White Hake and Pollock removed completely and lowest value of Capeline).</h4>
<p>From this figure it seems we have a fairly balanced residuals now. Although Northerbn Sandlance is show some extreme values (both large and small) for risk of overfitting the model we will stop removing variables and observations.</p>
<p>Now, since this is a General Linear Model and not a Generalized Linear Model we will need to check for the assumptions including linearity, independence of errors, homoscedasticity, and normality.</p>
</section>
</section>
<section id="testing-assumptions" class="level1">
<h1>Testing Assumptions</h1>
<section id="checking-for-normality" class="level3">
<h3 class="anchored" data-anchor-id="checking-for-normality">Checking for Normality</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(Q4_Reduced<span class="sc">$</span>residuals) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Q-Q plot appears to show normality</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Q4_Reduced<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Histogram appears to show normality</p>
</section>
<section id="shapiro-wilks-test" class="level3">
<h3 class="anchored" data-anchor-id="shapiro-wilks-test">Shapiro-Wilk’s Test</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(Q4_Reduced<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  Q4_Reduced$residuals
W = 0.98681, p-value = 0.8456</code></pre>
</div>
</div>
<p>From this W = 0.98681 and p-value = 0.8456. Given the p-value is not significant their is not a variation of the assumption of normality.</p>
<p>From these 3 explorations we are now confident in normality of the data.</p>
</section>
<section id="checking-for-homogeneity-of-variance" class="level3">
<h3 class="anchored" data-anchor-id="checking-for-homogeneity-of-variance">Checking for Homogeneity of Variance</h3>
<p>Using Breusch_Pagan Test</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span> (lmtest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lmtest</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: zoo</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'zoo'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    as.Date, as.Date.numeric</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(Q4_Reduced)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  Q4_Reduced
BP = 2.0797, df = 2, p-value = 0.3535</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># BP = 2.0797</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="co"># df = 2</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="co"># p-value = 0.3535</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Thus the p-value is greater then 0.05 so we accept the null hypothesis and assume we have homoscedasticity.</p>
</section>
<section id="checking-for-independence-of-predictor-variables" class="level3">
<h3 class="anchored" data-anchor-id="checking-for-independence-of-predictor-variables">Checking for Independence of Predictor Variables</h3>
<p>Using the Dublin-Watson</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(Q4_Reduced)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Durbin-Watson test

data:  Q4_Reduced
DW = 2.2815, p-value = 0.792
alternative hypothesis: true autocorrelation is greater than 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DW = 2.2815</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="co"># p-value = 0.792</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This p-value suggests very little to no autocorrelation.</p>
</section>
<section id="checking-for-correlation-of-the-variables" class="level3">
<h3 class="anchored" data-anchor-id="checking-for-correlation-of-the-variables">Checking for Correlation of the Variables</h3>
<section id="graphically-explore-for-correlation" class="level4">
<h4 class="anchored" data-anchor-id="graphically-explore-for-correlation">Graphically Explore for Correlation</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>( <span class="sc">~</span>Diet.diversity <span class="sc">+</span> Dietary.energy.density, <span class="at">data =</span> seal_data_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Data points look random and not correlated.</p>
</section>
<section id="numerically-explore-for-correlation" class="level4">
<h4 class="anchored" data-anchor-id="numerically-explore-for-correlation">Numerically Explore for Correlation</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>( <span class="sc">~</span>Diet.diversity <span class="sc">+</span> Dietary.energy.density, <span class="at">data =</span> seal_data_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  Diet.diversity and Dietary.energy.density
t = -3.0499, df = 48, p-value = 0.00372
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.6125589 -0.1402952
sample estimates:
      cor 
-0.402909 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># t = -0.35989</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="co"># df = 74</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="co"># p-value = 0.72</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>From this we can conclude that the variables are not correlated.</p>
<p>Thus, all our assumptions are met for the Linear Model and our findings can be accepted.</p>
</section>
</section>
</section>
<section id="generalized-linear-model" class="level1">
<h1>Generalized Linear Model</h1>
<p>Given we will be fitting a Gaussian (normal) distribution Generalized Linear Model it seeem safe to assume that the model will demonstrate the same data issues as the Linear Model with regard to residual outliers. For this reason we start with the reduced dataset that eliminated the the Dominant Prey Species White Hake, Pollock, and the lowest value of Capelin.</p>
<section id="fitting-full-generalized-linear-model-gaussian-family" class="level3">
<h3 class="anchored" data-anchor-id="fitting-full-generalized-linear-model-gaussian-family">Fitting Full Generalized Linear Model (Gaussian Family)</h3>
</section>
<section id="all-predictor-variables-1" class="level3">
<h3 class="anchored" data-anchor-id="all-predictor-variables-1">All Predictor Variables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>GLM_1 <span class="ot">=</span> <span class="fu">glm</span> (Pup.Wean.Mass <span class="sc">~</span> Dominant.prey.species <span class="sc">+</span> Diet.diversity <span class="sc">+</span> Dietary.energy.density <span class="sc">+</span> Year <span class="sc">+</span> Mom.Age <span class="sc">+</span> Pup.sex <span class="sc">+</span> MomID, <span class="at">data =</span> seal_data_3, <span class="at">family =</span> gaussian)</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span> (GLM_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Pup.Wean.Mass ~ Dominant.prey.species + Diet.diversity + 
    Dietary.energy.density + Year + Mom.Age + Pup.sex + MomID, 
    family = gaussian, data = seal_data_3)

Coefficients:
                                         Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)                            -1.076e+02  4.092e+02  -0.263   0.7940  
Dominant.prey.speciesCapelin           -4.464e+00  7.103e+00  -0.629   0.5332  
Dominant.prey.speciesNorthernSandlance -6.486e+00  5.592e+00  -1.160   0.2530  
Dominant.prey.speciesRedfish           -6.424e+00  5.363e+00  -1.198   0.2380  
Diet.diversity                         -2.408e+01  1.366e+01  -1.762   0.0856 .
Dietary.energy.density                 -3.922e+00  7.123e+00  -0.551   0.5850  
Year                                    9.835e-02  2.090e-01   0.471   0.6405  
Mom.Age                                -1.175e-01  2.425e-01  -0.484   0.6307  
Pup.sex                                -4.899e-01  1.762e+00  -0.278   0.7824  
MomID                                   4.208e-04  2.432e-04   1.730   0.0913 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 33.89238)

    Null deviance: 1745.4  on 49  degrees of freedom
Residual deviance: 1355.7  on 40  degrees of freedom
AIC: 328.9

Number of Fisher Scoring iterations: 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC = 328.9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>From here we will use the GLM_1 model for the Step Funtion to reduce the number of predictor variables and increase the accuracy and efficiency of the model.</p>
</section>
<section id="step-function-backward-3" class="level3">
<h3 class="anchored" data-anchor-id="step-function-backward-3">Step Function (Backward)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>backward.model <span class="ot">=</span> <span class="fu">step</span>(GLM_1, <span class="at">direction=</span><span class="st">'backward'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=328.9
Pup.Wean.Mass ~ Dominant.prey.species + Diet.diversity + Dietary.energy.density + 
    Year + Mom.Age + Pup.sex + MomID

                         Df Deviance    AIC
- Dominant.prey.species   3   1412.7 324.96
- Pup.sex                 1   1358.3 326.99
- Year                    1   1363.2 327.17
- Mom.Age                 1   1363.7 327.19
- Dietary.energy.density  1   1366.0 327.27
&lt;none&gt;                        1355.7 328.90
- MomID                   1   1457.2 330.51
- Diet.diversity          1   1461.0 330.64

Step:  AIC=324.96
Pup.Wean.Mass ~ Diet.diversity + Dietary.energy.density + Year + 
    Mom.Age + Pup.sex + MomID

                         Df Deviance    AIC
- Pup.sex                 1   1416.7 323.10
- Year                    1   1422.6 323.30
- Mom.Age                 1   1444.5 324.07
&lt;none&gt;                        1412.7 324.96
- MomID                   1   1509.7 326.28
- Dietary.energy.density  1   1521.1 326.65
- Diet.diversity          1   1571.7 328.29

Step:  AIC=323.1
Pup.Wean.Mass ~ Diet.diversity + Dietary.energy.density + Year + 
    Mom.Age + MomID

                         Df Deviance    AIC
- Year                    1   1430.0 321.57
- Mom.Age                 1   1449.0 322.23
&lt;none&gt;                        1416.7 323.10
- MomID                   1   1511.7 324.34
- Dietary.energy.density  1   1525.0 324.78
- Diet.diversity          1   1576.8 326.45

Step:  AIC=321.57
Pup.Wean.Mass ~ Diet.diversity + Dietary.energy.density + Mom.Age + 
    MomID

                         Df Deviance    AIC
- Mom.Age                 1   1449.0 320.23
&lt;none&gt;                        1430.0 321.57
- Dietary.energy.density  1   1525.9 322.81
- MomID                   1   1556.8 323.81
- Diet.diversity          1   1601.1 325.21

Step:  AIC=320.23
Pup.Wean.Mass ~ Diet.diversity + Dietary.energy.density + MomID

                         Df Deviance    AIC
&lt;none&gt;                        1449.0 320.23
- Dietary.energy.density  1   1569.6 322.22
- MomID                   1   1574.9 322.39
- Diet.diversity          1   1661.7 325.07</code></pre>
</div>
</div>
<p>The backward step retained the Diet Diversity and Dietary.energy.density variables with AIC AIC = 320.23. It should be noted this is the same predictor variables that were selected in the Step Function as the Linear Model but the AIC is much worse then the reduced Linear Model with AIC = 178.5. This is because the Linear Model is a less complex model and thus has a lower AIC.</p>
</section>
<section id="explore-backward-step-linear-model-1" class="level3">
<h3 class="anchored" data-anchor-id="explore-backward-step-linear-model-1">Explore Backward Step Linear Model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>GLM_2 <span class="ot">=</span> <span class="fu">glm</span>(Pup.Wean.Mass <span class="sc">~</span> Dietary.energy.density <span class="sc">+</span> Diet.diversity,</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> seal_data_3, <span class="at">family =</span> gaussian)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(GLM_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Pup.Wean.Mass ~ Dietary.energy.density + Diet.diversity, 
    family = gaussian, data = seal_data_3)

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)              98.933     29.029   3.408  0.00135 **
Dietary.energy.density   -6.614      4.689  -1.410  0.16503   
Diet.diversity          -26.461     12.140  -2.180  0.03432 * 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 33.50838)

    Null deviance: 1745.4  on 49  degrees of freedom
Residual deviance: 1574.9  on 47  degrees of freedom
AIC: 322.39

Number of Fisher Scoring iterations: 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC = 322.39</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="explore-residuals-1" class="level1">
<h1>Explore Residuals</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(GLM_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-17---residual-for-generalized-linear-model-with-reduced-dataset" class="level4">
<h4 class="anchored" data-anchor-id="figure-17---residual-for-generalized-linear-model-with-reduced-dataset">Figure 17 - Residual for Generalized Linear Model With Reduced Dataset</h4>
<p>As we might expect the residuals for this Gaussian Generalized Linear Model are very similar to the residuals for the Linear Model above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(GLM_2, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid, <span class="at">color =</span> seal_data_3<span class="sc">$</span>Dominant.prey.species )) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Q2_markdown_April.16_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="figure-18---residual-for-generalized-linear-model-with-reduced-dataset" class="level4">
<h4 class="anchored" data-anchor-id="figure-18---residual-for-generalized-linear-model-with-reduced-dataset">Figure 18 - Residual for Generalized Linear Model With Reduced Dataset</h4>
<p>Again, as we might expect the residuals for this Gaussian Generalized Linear Model are very similar to the residuals for the Linear Model above. Given the Generalized Linear Model is creating similar residuals with the a same predictor variables as the Linear Model but with a less desirable AIC (GLM = 322.39 vs.&nbsp;LM = 178.5), it<br>
seems the more simple Linear Model should be used.</p>
</section>
</section>
<section id="fit-linear-mixed-model" class="level1">
<h1>Fit Linear Mixed Model</h1>
<p>The Linear Model may benefit from Random Effects on the Dominant Prey Species variable given the different prey species would have an effect on the other two remaining variables, Dietary Energy Density and Diet Diversity.</p>
<section id="linear-mixed-model-with-both-diet-diversity-and-dietary-energy-loss-random-effects-based-on-cluster-variable-dominant-prey-species" class="level3">
<h3 class="anchored" data-anchor-id="linear-mixed-model-with-both-diet-diversity-and-dietary-energy-loss-random-effects-based-on-cluster-variable-dominant-prey-species">Linear Mixed Model With Both Diet Diversity and Dietary Energy Loss Random Effects Based on Cluster Variable Dominant Prey Species</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(lme4)</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>GLMM_1 <span class="ot">=</span> <span class="fu">lmer</span>(Pup.Wean.Mass <span class="sc">~</span>  Diet.diversity <span class="sc">+</span> Dietary.energy.density <span class="sc">+</span>  (Dietary.energy.density <span class="sc">|</span> Dominant.prey.species ) <span class="sc">+</span> (Diet.diversity <span class="sc">|</span> Dominant.prey.species) , <span class="at">data =</span> seal_data_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(GLMM_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: 
Pup.Wean.Mass ~ Diet.diversity + Dietary.energy.density + (Dietary.energy.density |  
    Dominant.prey.species) + (Diet.diversity | Dominant.prey.species)
   Data: seal_data_3

REML criterion at convergence: 301.5

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.6560 -0.7911  0.1412  0.7235  2.4302 

Random effects:
 Groups                  Name                   Variance  Std.Dev. Corr 
 Dominant.prey.species   (Intercept)            1.228e-02 0.11081       
                         Dietary.energy.density 3.838e-04 0.01959  -1.00
 Dominant.prey.species.1 (Intercept)            0.000e+00 0.00000       
                         Diet.diversity         2.394e-04 0.01547   NaN 
 Residual                                       3.351e+01 5.78864       
Number of obs: 50, groups:  Dominant.prey.species, 4

Fixed effects:
                       Estimate Std. Error t value
(Intercept)              98.933     29.029   3.408
Diet.diversity          -26.461     12.140  -2.180
Dietary.energy.density   -6.613      4.689  -1.410

Correlation of Fixed Effects:
            (Intr) Dt.dvr
Diet.dvrsty -0.522       
Dtry.nrgy.d -0.991  0.403
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extractAIC</span>(GLMM_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  10.0000 334.3899</code></pre>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC = 337.7947</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="linear-mixed-model-with-dietary-energy-loss-random-effects-based-on-cluster-variable-dominant-prey-species" class="level3">
<h3 class="anchored" data-anchor-id="linear-mixed-model-with-dietary-energy-loss-random-effects-based-on-cluster-variable-dominant-prey-species">Linear Mixed Model With Dietary Energy Loss Random Effects Based on Cluster Variable Dominant Prey Species</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>GLMM_2 <span class="ot">=</span> <span class="fu">lmer</span>(Pup.Wean.Mass <span class="sc">~</span>  Diet.diversity <span class="sc">+</span> Dietary.energy.density <span class="sc">+</span>  (Dietary.energy.density <span class="sc">|</span> Dominant.prey.species ), <span class="at">data =</span> seal_data_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(GLMM_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: 
Pup.Wean.Mass ~ Diet.diversity + Dietary.energy.density + (Dietary.energy.density |  
    Dominant.prey.species)
   Data: seal_data_3

REML criterion at convergence: 301.5

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.6560 -0.7911  0.1412  0.7235  2.4302 

Random effects:
 Groups                Name                   Variance  Std.Dev. Corr 
 Dominant.prey.species (Intercept)            1.420e-03 0.037686      
                       Dietary.energy.density 4.228e-05 0.006502 -1.00
 Residual                                     3.351e+01 5.788642      
Number of obs: 50, groups:  Dominant.prey.species, 4

Fixed effects:
                       Estimate Std. Error t value
(Intercept)              98.933     29.029   3.408
Diet.diversity          -26.461     12.140  -2.180
Dietary.energy.density   -6.614      4.689  -1.410

Correlation of Fixed Effects:
            (Intr) Dt.dvr
Diet.dvrsty -0.522       
Dtry.nrgy.d -0.991  0.403
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extractAIC</span>(GLMM_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]   7.0000 328.3899</code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC = 328.3899</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="linear-mixed-model-with-diet-diversity-random-effects-based-on-cluster-variable-dominant-prey-species" class="level3">
<h3 class="anchored" data-anchor-id="linear-mixed-model-with-diet-diversity-random-effects-based-on-cluster-variable-dominant-prey-species">Linear Mixed Model With Diet Diversity Random Effects Based on Cluster Variable Dominant Prey Species</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>GLMM_3 <span class="ot">=</span> <span class="fu">lmer</span>(Pup.Wean.Mass <span class="sc">~</span>  Diet.diversity <span class="sc">+</span> Dietary.energy.density <span class="sc">+</span> (Diet.diversity <span class="sc">|</span> Dominant.prey.species) , <span class="at">data =</span> seal_data_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(GLMM_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: 
Pup.Wean.Mass ~ Diet.diversity + Dietary.energy.density + (Diet.diversity |  
    Dominant.prey.species)
   Data: seal_data_3

REML criterion at convergence: 301.5

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.6560 -0.7911  0.1412  0.7235  2.4302 

Random effects:
 Groups                Name           Variance  Std.Dev.  Corr
 Dominant.prey.species (Intercept)    0.000e+00 0.000e+00     
                       Diet.diversity 2.911e-17 5.395e-09  NaN
 Residual                             3.351e+01 5.789e+00     
Number of obs: 50, groups:  Dominant.prey.species, 4

Fixed effects:
                       Estimate Std. Error t value
(Intercept)              98.933     29.029   3.408
Diet.diversity          -26.461     12.140  -2.180
Dietary.energy.density   -6.614      4.689  -1.410

Correlation of Fixed Effects:
            (Intr) Dt.dvr
Diet.dvrsty -0.522       
Dtry.nrgy.d -0.991  0.403
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extractAIC</span>(GLMM_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]   7.0000 328.3899</code></pre>
</div>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC = 328.3899</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="linear-mixed-model-with-intercept-random-effects-based-on-cluster-variable-dominant-prey-species" class="level3">
<h3 class="anchored" data-anchor-id="linear-mixed-model-with-intercept-random-effects-based-on-cluster-variable-dominant-prey-species">Linear Mixed Model With Intercept Random Effects Based on Cluster Variable Dominant Prey Species</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>GLMM_4 <span class="ot">=</span> <span class="fu">lmer</span>(Pup.Wean.Mass <span class="sc">~</span>  Diet.diversity <span class="sc">+</span> Dietary.energy.density <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Dominant.prey.species) , <span class="at">data =</span> seal_data_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(GLMM_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: Pup.Wean.Mass ~ Diet.diversity + Dietary.energy.density + (1 |  
    Dominant.prey.species)
   Data: seal_data_3

REML criterion at convergence: 301.5

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.6560 -0.7911  0.1412  0.7235  2.4302 

Random effects:
 Groups                Name        Variance Std.Dev.
 Dominant.prey.species (Intercept)  0.00    0.000   
 Residual                          33.51    5.789   
Number of obs: 50, groups:  Dominant.prey.species, 4

Fixed effects:
                       Estimate Std. Error t value
(Intercept)              98.933     29.029   3.408
Diet.diversity          -26.461     12.140  -2.180
Dietary.energy.density   -6.614      4.689  -1.410

Correlation of Fixed Effects:
            (Intr) Dt.dvr
Diet.dvrsty -0.522       
Dtry.nrgy.d -0.991  0.403
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extractAIC</span>(GLMM_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in optwrap(optimizer, devfun, x@theta, lower = x@lower, calc.derivs =
TRUE, : convergence code 3 from bobyqa: bobyqa -- a trust region step failed to
reduce q</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]   5.0000 324.3899</code></pre>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC = 324.3899</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>So, in summary, none of the Linear Mixed Models with Random Effect on the cluster variavble Dominant Prey Species resulted in a more desirable AIC. The best Mixed Model model had an AIC = 324.3899 but the best Linear Model had an AIC=178.496. Thus the less complex Linear Model is the most efficient and most accurate model.</p>
</section>
</section>
<section id="cross-validation" class="level1">
<h1>Cross Validation</h1>
<p>It has been determined that a simple Linear Model using a maternal mother seal’s Dietary Energy Density and Diet Diversity are the best predictor variables for Pup Wean Mass. The model lm(Pup.Wean.Mass ~ Dietary.energy.density + Diet.diversity, data = seal_data_3) has shown an AIC = 178.496.</p>
<p>We will now use Cross Validation to assess how well we expect this model to preform when predicting future Pup Wean Mass changes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(modelr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: modelr</code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: caret</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(readr)</span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(seal_data_3)</span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set Random Seed</span></span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1980</span>)</span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Index Matrix (80% train data and 20% test data )</span></span>
<span id="cb184-10"><a href="#cb184-10" aria-hidden="true" tabindex="-1"></a>index <span class="ot">=</span> <span class="fu">createDataPartition</span>(seal_data_3<span class="sc">$</span>Pup.Wean.Mass, <span class="at">p =</span> .<span class="dv">8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>, <span class="at">times =</span> <span class="dv">1</span>)</span>
<span id="cb184-11"><a href="#cb184-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-12"><a href="#cb184-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(seal_data_3<span class="sc">$</span>Pup.Wean.Mass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  37.50   47.62   52.00   51.54   55.50   63.00 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(seal_data_3<span class="sc">$</span>Pup.Wean.Mass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 50.5 60.5 50.0 54.5 45.5 37.5 54.5 59.0 50.5 51.0 58.5 59.0 56.0 55.0 56.0
[16] 51.5 59.5 45.5 50.0 47.5 53.5 49.0 55.0 52.5 54.0 55.0 53.0 45.5 56.5 60.0
[31] 48.0 55.5 56.5 48.5 46.5 63.0 43.5 55.5 54.0 51.0 41.5 48.0 53.0 40.0 45.5
[46] 44.0 40.0 61.0 46.0 50.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert data frame</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>data_frame <span class="ot">=</span> <span class="fu">as.data.frame</span>(seal_data_3)</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame for the train data that is 80%</span></span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>train_data_frame <span class="ot">=</span> data_frame[index,]</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame for the test data that is 20% ("-" before index mean everything but the 80%)</span></span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>test_data_frame <span class="ot">=</span> data_frame[<span class="sc">-</span>index,]</span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert response variable in both train and test data frame to a factor</span></span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a>train_data_frame<span class="sc">$</span>Pup.Wean.Mass <span class="ot">=</span> <span class="fu">as.factor</span> (train_data_frame<span class="sc">$</span>Pup.Wean.Mass)</span>
<span id="cb188-12"><a href="#cb188-12" aria-hidden="true" tabindex="-1"></a>test_data_frame<span class="sc">$</span>Pup.Wean.Mass <span class="ot">=</span> <span class="fu">as.factor</span> (test_data_frame<span class="sc">$</span>Pup.Wean.Mass)</span>
<span id="cb188-13"><a href="#cb188-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-14"><a href="#cb188-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-15"><a href="#cb188-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure the response variables classes are factors</span></span>
<span id="cb188-16"><a href="#cb188-16" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span> (train_data_frame<span class="sc">$</span>Pup.Wean.Mass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "factor"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># "factor"</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span> (test_data_frame<span class="sc">$</span>Pup.Wean.Mass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "factor"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># "factor"</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify type of training method used and the number of folds</span></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>control_specs <span class="ot">=</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">11</span> , <span class="at">savePredictions =</span> <span class="st">"all"</span>)</span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set Random Seed</span></span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1980</span>)</span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(randomForest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: randomForest</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>randomForest 4.7-1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Type rfNews() to see new features/changes/bug fixes.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'randomForest'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    margin</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># now we train the model with the best fit GLM above</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="co"># GLM_Final = glm (seal_data$Pup.Wean.Mass ~ seal_data$Dominant.prey.species + seal_data$Diet.diversity, family = gaussian)</span></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>model_cross <span class="ot">=</span> <span class="fu">train</span>(Pup.Wean.Mass <span class="sc">~</span> Dominant.prey.species <span class="sc">+</span> Diet.diversity,</span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">data =</span> seal_data_3, <span class="at">trControl =</span> control_specs)</span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> (model_cross)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear Regression 

50 samples
 2 predictor

No pre-processing
Resampling: Cross-Validated (11 fold) 
Summary of sample sizes: 45, 46, 46, 44, 46, 46, ... 
Resampling results:

  RMSE      Rsquared   MAE     
  5.434521  0.2021304  4.563434

Tuning parameter 'intercept' was held constant at a value of TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 50 samples</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  2 predictor</span></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  RMSE      Rsquared    MAE</span></span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 5.434521  0.20213048  4.563434</span></span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-8"><a href="#cb201-8" aria-hidden="true" tabindex="-1"></a><span class="co"># We now apply the model to the test_data_frame we created from 20%</span></span>
<span id="cb201-9"><a href="#cb201-9" aria-hidden="true" tabindex="-1"></a><span class="co"># of the data that the new model created from the 11 folds has not yet seen</span></span>
<span id="cb201-10"><a href="#cb201-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-11"><a href="#cb201-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict outcome using model from train_data_frame applied to test_data_frame</span></span>
<span id="cb201-12"><a href="#cb201-12" aria-hidden="true" tabindex="-1"></a>Predict_Data <span class="ot">=</span> <span class="fu">predict</span> (model_cross, <span class="at">newdata =</span> test_data_frame)</span>
<span id="cb201-13"><a href="#cb201-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-14"><a href="#cb201-14" aria-hidden="true" tabindex="-1"></a><span class="co"># predictions results</span></span>
<span id="cb201-15"><a href="#cb201-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-16"><a href="#cb201-16" aria-hidden="true" tabindex="-1"></a><span class="co">#. 52.74225 51.24721 50.67234 57.30204 51.49974 49.31590 50.08707 48.16223 </span></span>
<span id="cb201-17"><a href="#cb201-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-18"><a href="#cb201-18" aria-hidden="true" tabindex="-1"></a>test_data_frame<span class="sc">$</span>Pup.Wean.Mass</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 59   59.5 49   55   52.5 41.5 48   40  
Levels: 40 41.5 48 49 52.5 55 59 59.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 59   59.5 49   55   52.5 41.5 48   40  </span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Creates vectors having data points</span></span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>predicted_value <span class="ot">&lt;-</span> (<span class="fu">c</span>(<span class="fl">52.74225</span>, <span class="fl">51.24721</span>, <span class="fl">50.67234</span>, <span class="fl">57.30204</span>, <span class="fl">51.49974</span>, <span class="fl">49.31590</span>, <span class="fl">50.08707</span>, <span class="fl">48.16223</span>))</span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>expected_value <span class="ot">&lt;-</span> (<span class="fu">c</span>(<span class="dv">59</span>, <span class="fl">59.5</span>, <span class="dv">49</span>, <span class="dv">55</span>, <span class="fl">52.5</span>, <span class="fl">41.5</span>, <span class="dv">48</span>, <span class="dv">40</span>))</span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true" tabindex="-1"></a>Cross_Validation_Corrolation <span class="ot">=</span> <span class="fu">cor</span> (predicted_value, expected_value)</span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-10"><a href="#cb203-10" aria-hidden="true" tabindex="-1"></a><span class="do">### 0.6596914</span></span>
<span id="cb203-11"><a href="#cb203-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-12"><a href="#cb203-12" aria-hidden="true" tabindex="-1"></a>R2 <span class="ot">=</span> (Cross_Validation_Corrolation<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb203-13"><a href="#cb203-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-14"><a href="#cb203-14" aria-hidden="true" tabindex="-1"></a><span class="do">### 0.4351927 (43.52% of variance)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>From this cross validation procedure we can see that the Linear Model has a validation score of about 0.66 which mean the Linear Model would do a fair job at predicting Pup Mean Mass based on the maternal mother seal’s Dietary Energy Density and Diet Diversity. The estimated R-squared value suggests the model would account for about 43.5% of the variance of Pup Mean Mass.</p>
</section>
<section id="results" class="level1">
<h1>Results</h1>
<p>Although it was proposed that many predictor variables (2 continuous + 3 categorical for question one and 2 continuous + 5 categorical for question two) would allow greater computational potential to establish a well fit model, the added complexity of these variables was observed to significantly increase the AIC and potentially overfit the model. It was found, particularly in question two, that the simplicity of a Linear Model with a Least Square approach resulted in a simpler linear model with a significantly lower AIC.</p>
<p>In question 2 it was found that best fit Linear Model for Pup Wean Mass included the predictor variables Dietary Energy Density and Diet Diversity with an AIC = 178.496. When a Generalized Linear Model was explored with a Gaussian Family and Identity Link Function it was also found that the best fit model included Dietary Energy Density and Diet Diversity predictor variable but the AIC was much less preferable at 322.39. The reasons for this decreased predicted fit is likely based on the more complex Maximum Likelihood Estimation used in Generalized Linear Models rather than the Linear Least Square method used in the Linear Models. Generalized Linear Mixed Models (GLMM) were also explored using the Dominant Prey Species as the Cluster Variable because it was assumed that this variable would likely have a effect on the prey energy density as well as the diet diversity based on feeding location ecosystems. The best fit GLMM was found to include Diet Diversity and Dietary Energy Density as fixed effects predictor variables and Dominant Prey Species as an intercept random effect variable which had a AIC of 324.3899. As a result it was determined that the best fit model to determine Pup Wean Mass was the Linear Model and this model was tested using Cross Validation. The correlation of predicted values to actual values showed a value of 0.6596914 meaning the Linear Model could be expected to predict Pup Wean Mass with about a 66 percent accuracy.</p>
</section>
<section id="conclusions" class="level1">
<h1>Conclusions</h1>
</section>
<section id="references" class="level1">
<h1>References</h1>
<section id="data-source-sara-iverson-laboratory-and-dfo-grey-seal-program." class="level4">
<h4 class="anchored" data-anchor-id="data-source-sara-iverson-laboratory-and-dfo-grey-seal-program.">Data source : Sara Iverson laboratory and DFO Grey Seal Program.</h4>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>